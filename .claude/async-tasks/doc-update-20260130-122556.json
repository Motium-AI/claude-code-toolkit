{
  "type": "doc-update",
  "created_at": "2026-01-30T12:25:56.093778+00:00",
  "status": "pending",
  "commit_message": "feat(hooks): add lite-heavy enforcement hooks\n\n- lite-heavy-enforcer.py: Blocks ExitPlanMode until Lite Heavy agents are launched\n- lite-heavy-tracker.py: Tracks Task agent launches for Lite Heavy pattern\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 12aa509def058c91353fb88bf23441ee4fe4092a\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 13:25:56 2026 +0100\n\n    feat(hooks): add lite-heavy enforcement hooks\n    \n    - lite-heavy-enforcer.py: Blocks ExitPlanMode until Lite Heavy agents are launched\n    - lite-heavy-tracker.py: Tracks Task agent launches for Lite Heavy pattern\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/lite-heavy-enforcer.py | 127 ++++++++++++++++++++++++++++++++++++\n config/hooks/lite-heavy-tracker.py  | 125 +++++++++++++++++++++++++++++++++++\n 2 files changed, 252 insertions(+)\n\ndiff --git a/config/hooks/lite-heavy-enforcer.py b/config/hooks/lite-heavy-enforcer.py\nnew file mode 100644\nindex 0000000..4d16d99\n--- /dev/null\n+++ b/config/hooks/lite-heavy-enforcer.py\n@@ -0,0 +1,127 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PreToolUse hook to enforce Lite Heavy execution before ExitPlanMode for /forge.\n+\n+Blocks ExitPlanMode until:\n+1. heavy/SKILL.md has been read\n+2. \"First Principles\" Task agent has been launched\n+3. \"AGI-Pilled\" Task agent has been launched\n+\n+The tracking is done by lite-heavy-tracker.py (PostToolUse hook).\n+This hook only checks the state and blocks if requirements aren't met.\n+\n+Hook event: PreToolUse\n+Matcher: ExitPlanMode\n+\n+Exit codes:\n+  0 - Decision made (deny via hookSpecificOutput or silent passthrough)\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+# Add hooks directory to path for shared imports\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import get_autonomous_state, log_debug\n+\n+\n+BLOCK_MESSAGE = \"\"\"\n+\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n+\u2551  \u26a0\ufe0f  LITE HEAVY PLANNING REQUIRED - /forge                                    \u2551\n+\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n+\n+Before exiting plan mode, you MUST complete Lite Heavy planning:\n+\n+\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n+\u2502  REQUIRED STEPS:                                                                \u2502\n+\u2502                                                                                 \u2502\n+\u2502  {step1}  1. Read ~/.claude/skills/heavy/SKILL.md (get agent prompts)           \u2502\n+\u2502  {step2}  2. Launch Task: \"First Principles Analysis\" (from heavy)              \u2502\n+\u2502  {step3}  3. Launch Task: \"AGI-Pilled Analysis\" (from heavy)                    \u2502\n+\u2502  4. Synthesize their responses into your plan                                   \u2502\n+\u2502                                                                                 \u2502\n+\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n+\n+WHY LITE HEAVY?\n+- First Principles asks: \"What can be deleted? What's over-engineered?\"\n+- AGI-Pilled asks: \"What would god-tier AI implementation look like?\"\n+- Together they prevent both over-engineering AND under-ambition\n+\n+Complete the missing steps, then ExitPlanMode again.\n+\"\"\".strip()\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError as e:\n+        log_debug(\"Failed to parse JSON input\", hook_name=\"lite-heavy-enforcer\", error=e)\n+        sys.exit(0)\n+\n+    cwd = input_data.get(\"cwd\", \"\") or os.getcwd()\n+    tool_name = input_data.get(\"tool_name\", \"\")\n+    session_id = input_data.get(\"session_id\", \"\")\n+\n+    # Only process ExitPlanMode\n+    if tool_name != \"ExitPlanMode\":\n+        sys.exit(0)\n+\n+    # Only process if forge is active\n+    state, state_type = get_autonomous_state(cwd, session_id)\n+    if state_type != \"forge\":\n+        sys.exit(0)\n+\n+    # Only enforce on first iteration\n+    iteration = state.get(\"iteration\", 1)\n+    if iteration > 1:\n+        sys.exit(0)\n+\n+    # Check Lite Heavy requirements\n+    lite_heavy = state.get(\"lite_heavy_verification\", {})\n+    heavy_skill_read = lite_heavy.get(\"heavy_skill_read\", False)\n+    first_principles_launched = lite_heavy.get(\"first_principles_launched\", False)\n+    agi_pilled_launched = lite_heavy.get(\"agi_pilled_launched\", False)\n+\n+    # If all requirements met, allow ExitPlanMode\n+    if heavy_skill_read and first_principles_launched and agi_pilled_launched:\n+        log_debug(\n+            \"Lite Heavy requirements met, allowing ExitPlanMode\",\n+            hook_name=\"lite-heavy-enforcer\"\n+        )\n+        sys.exit(0)\n+\n+    # Block with specific feedback\n+    step1 = \"\u2713\" if heavy_skill_read else \"\u2717\"\n+    step2 = \"\u2713\" if first_principles_launched else \"\u2717\"\n+    step3 = \"\u2713\" if agi_pilled_launched else \"\u2717\"\n+\n+    message = BLOCK_MESSAGE.format(step1=step1, step2=step2, step3=step3)\n+\n+    log_debug(\n+        \"Blocking ExitPlanMode - Lite Heavy incomplete\",\n+        hook_name=\"lite-heavy-enforcer\",\n+        parsed_data={\n+            \"heavy_skill_read\": heavy_skill_read,\n+            \"first_principles_launched\": first_principles_launched,\n+            \"agi_pilled_launched\": agi_pilled_launched,\n+        }\n+    )\n+\n+    output = {\n+        \"hookSpecificOutput\": {\n+            \"hookEventName\": \"PreToolUse\",\n+            \"permissionDecision\": \"deny\",\n+            \"permissionDecisionReason\": message,\n+        }\n+    }\n+\n+    print(json.dumps(output))\n+    sys.exit(0)\n+\n+\n+if __name__ == \"__main__\":\n+    main()\ndiff --git a/config/hooks/lite-heavy-tracker.py b/config/hooks/lite-heavy-tracker.py\nnew file mode 100644\nindex 0000000..8febee1\n--- /dev/null\n+++ b/config/hooks/lite-heavy-tracker.py\n@@ -0,0 +1,125 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PostToolUse hook to track Lite Heavy progress for /forge skill.\n+\n+Tracks when:\n+1. heavy/SKILL.md is read\n+2. Task agents with \"First Principles\" or \"AGI-Pilled\" in description are launched\n+\n+Updates forge-state.json with lite_heavy_verification status.\n+\n+Hook event: PostToolUse\n+Matcher: Read, Task\n+\n+Exit codes:\n+  0 - Always (non-blocking tracker)\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+# Add hooks directory to path for shared imports\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import get_autonomous_state, log_debug\n+\n+\n+def is_heavy_skill_path(file_path: str) -> bool:\n+    \"\"\"Check if the file path is heavy/SKILL.md.\"\"\"\n+    if not file_path:\n+        return False\n+    return (\n+        file_path.endswith(\"heavy/SKILL.md\") or\n+        \"/skills/heavy/SKILL.md\" in file_path or\n+        \"skills/heavy/SKILL.md\" in file_path\n+    )\n+\n+\n+def detect_agent_type(task_description: str) -> str | None:\n+    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\"\"\"\n+    if not task_description:\n+        return None\n+\n+    desc_lower = task_description.lower()\n+\n+    if \"first principles\" in desc_lower or \"first-principles\" in desc_lower:\n+        return \"first_principles\"\n+\n+    if \"agi-pilled\" in desc_lower or \"agi pilled\" in desc_lower or \"agipilled\" in desc_lower:\n+        return \"agi_pilled\"\n+\n+    return None\n+\n+\n+def update_lite_heavy_state(cwd: str, updates: dict) -> bool:\n+    \"\"\"Update the Lite Heavy verification state in forge-state.json.\"\"\"\n+    state_path = Path(cwd) / \".claude\" / \"forge-state.json\"\n+    if not state_path.exists():\n+        return False\n+\n+    try:\n+        state = json.loads(state_path.read_text())\n+\n+        if \"lite_heavy_verification\" not in state:\n+            state[\"lite_heavy_verification\"] = {\n+                \"heavy_skill_read\": False,\n+                \"first_principles_launched\": False,\n+                \"agi_pilled_launched\": False,\n+            }\n+\n+        state[\"lite_heavy_verification\"].update(updates)\n+        state_path.write_text(json.dumps(state, indent=2))\n+        return True\n+    except (json.JSONDecodeError, OSError) as e:\n+        log_debug(f\"Failed to update lite heavy state: {e}\", hook_name=\"lite-heavy-tracker\")\n+        return False\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError:\n+      \n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/index.md",
    "docs/philosophy.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an appfix/godo session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nfeat(hooks): add lite-heavy enforcement hooks\n\n- lite-heavy-enforcer.py: Blocks ExitPlanMode until Lite Heavy agents are launched\n- lite-heavy-tracker.py: Tracks Task agent launches for Lite Heavy pattern\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/index.md\n- docs/philosophy.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 12aa509def058c91353fb88bf23441ee4fe4092a\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 13:25:56 2026 +0100\n\n    feat(hooks): add lite-heavy enforcement hooks\n    \n    - lite-heavy-enforcer.py: Blocks ExitPlanMode until Lite Heavy agents are launched\n    - lite-heavy-tracker.py: Tracks Task agent launches for Lite Heavy pattern\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/lite-heavy-enforcer.py | 127 ++++++++++++++++++++++++++++++++++++\n config/hooks/lite-heavy-tracker.py  | 125 +++++++++++++++++++++++++++++++++++\n 2 files changed, 252 insertions(+)\n\ndiff --git a/config/hooks/lite-heavy-enforcer.py b/config/hooks/lite-heavy-enforcer.py\nnew file mode 100644\nindex 0000000..4d16d99\n--- /dev/null\n+++ b/config/hooks/lite-heavy-enforcer.py\n@@ -0,0 +1,127 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PreToolUse hook to enforce Lite Heavy execution before ExitPlanMode for /forge.\n+\n+Blocks ExitPlanMode until:\n+1. heavy/SKILL.md has been read\n+2. \"First Principles\" Task agent has been launched\n+3. \"AGI-Pilled\" Task agent has been launched\n+\n+The tracking is done by lite-heavy-tracker.py (PostToolUse hook).\n+This hook only checks the state and blocks if requirements aren't met.\n+\n+Hook event: PreToolUse\n+Matcher: ExitPlanMode\n+\n+Exit codes:\n+  0 - Decision made (deny via hookSpecificOutput or silent passthrough)\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+# Add hooks directory to path for shared imports\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import get_autonomous_state, log_debug\n+\n+\n+BLOCK_MESSAGE = \"\"\"\n+\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n+\u2551  \u26a0\ufe0f  LITE HEAVY PLANNING REQUIRED - /forge                                    \u2551\n+\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n+\n+Before exiting plan mode, you MUST complete Lite Heavy planning:\n+\n+\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n+\u2502  REQUIRED STEPS:                                                                \u2502\n+\u2502                                                                                 \u2502\n+\u2502  {step1}  1. Read ~/.claude/skills/heavy/SKILL.md (get agent prompts)           \u2502\n+\u2502  {step2}  2. Launch Task: \"First Principles Analysis\" (from heavy)              \u2502\n+\u2502  {step3}  3. Launch Task: \"AGI-Pilled Analysis\" (from heavy)                    \u2502\n+\u2502  4. Synthesize their responses into your plan                                   \u2502\n+\u2502                                                                                 \u2502\n+\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n+\n+WHY LITE HEAVY?\n+- First Principles asks: \"What can be deleted? What's over-engineered?\"\n+- AGI-Pilled asks: \"What would god-tier AI implementation look like?\"\n+- Together they prevent both over-engineering AND under-ambition\n+\n+Complete the missing steps, then ExitPlanMode again.\n+\"\"\".strip()\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError as e:\n+        log_debug(\"Failed to parse JSON input\", hook_name=\"lite-heavy-enforcer\", error=e)\n+        sys.exit(0)\n+\n+    cwd = input_data.get(\"cwd\", \"\") or os.getcwd()\n+    tool_name = input_data.get(\"tool_name\", \"\")\n+    session_id = input_data.get(\"session_id\", \"\")\n+\n+    # Only process ExitPlanMode\n+    if tool_name != \"ExitPlanMode\":\n+        sys.exit(0)\n+\n+    # Only process if forge is active\n+    state, state_type = get_autonomous_state(cwd, session_id)\n+    if state_type != \"forge\":\n+        sys.exit(0)\n+\n+    # Only enforce on first iteration\n+    iteration = state.get(\"iteration\", 1)\n+    if iteration > 1:\n+        sys.exit(0)\n+\n+    # Check Lite Heavy requirements\n+    lite_heavy = state.get(\"lite_heavy_verification\", {})\n+    heavy_skill_read = lite_heavy.get(\"heavy_skill_read\", False)\n+    first_principles_launched = lite_heavy.get(\"first_principles_launched\", False)\n+    agi_pilled_launched = lite_heavy.get(\"agi_pilled_launched\", False)\n+\n+    # If all requirements met, allow ExitPlanMode\n+    if heavy_skill_read and first_principles_launched and agi_pilled_launched:\n+        log_debug(\n+            \"Lite Heavy requirements met, allowing ExitPlanMode\",\n+            hook_name=\"lite-heavy-enforcer\"\n+        )\n+        sys.exit(0)\n+\n+    # Block with specific feedback\n+    step1 = \"\u2713\" if heavy_skill_read else \"\u2717\"\n+    step2 = \"\u2713\" if first_principles_launched else \"\u2717\"\n+    step3 = \"\u2713\" if agi_pilled_launched else \"\u2717\"\n+\n+    message = BLOCK_MESSAGE.format(step1=step1, step2=step2, step3=step3)\n+\n+    log_debug(\n+        \"Blocking ExitPlanMode - Lite Heavy incomplete\",\n+        hook_name=\"lite-heavy-enforcer\",\n+        parsed_data={\n+            \"heavy_skill_read\": heavy_skill_read,\n+            \"first_principles_launched\": first_principles_launched,\n+            \"agi_pilled_launched\": agi_pilled_launched,\n+        }\n+    )\n+\n+    output = {\n+        \"hookSpecificOutput\": {\n+            \"hookEventName\": \"PreToolUse\",\n+            \"permissionDecision\": \"deny\",\n+            \"permissionDecisionReason\": message,\n+        }\n+    }\n+\n+    print(json.dumps(output))\n+    sys.exit(0)\n+\n+\n+if __name__ == \"__main__\":\n+    main()\ndiff --git a/config/hooks/lite-heavy-tracker.py b/config/hooks/lite-heavy-tracker.py\nnew file mode 100644\nindex 0000000..8febee1\n--- /dev/null\n+++ b/config/hooks/lite-heavy-tracker.py\n@@ -0,0 +1,125 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PostToolUse hook to track Lite Heavy progress for /forge skill.\n+\n+Tracks when:\n+1. heavy/SKILL.md is read\n+2. Task agents with \"First Principles\" or \"AGI-Pilled\" in description are launched\n+\n+Updates forge-state.json with lite_heavy_verification status.\n+\n+Hook event: PostToolUse\n+Matcher: Read, Task\n+\n+Exit codes:\n+  0 - Always (non-blocking tracker)\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+# Add hooks directory to path for shared imports\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import get_autonomous_state, log_debug\n+\n+\n+def is_heavy_skill_path(file_path: str) -> bool:\n+    \"\"\"Check if the file path is heavy/SKILL.md.\"\"\"\n+    if not file_path:\n+        return False\n+    return (\n+        file_path.endswith(\"heavy/SKILL.md\") or\n+        \"/skills/heavy/SKILL.md\" in file_path or\n+        \"skills/heavy/SKILL.md\" in file_path\n+    )\n+\n+\n+def detect_agent_type(task_description: str) -> str | None:\n+    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\"\"\"\n+    if not task_description:\n+        return None\n+\n+    desc_lower = task_description.lower()\n+\n+    if \"first principles\" in desc_lower or \"first-principles\" in desc_lower:\n+        return \"first_principles\"\n+\n+    if \"agi-pilled\" in desc_lower or \"agi pilled\" in desc_lower or \"agipilled\" in desc_lower:\n+        return \"agi_pilled\"\n+\n+    return None\n+\n+\n+def update_lite_heavy_state(cwd: str, updates: dict) -> bool:\n+    \"\"\"Update the Lite Heavy verification state in forge-state.json.\"\"\"\n+    state_path = Path(cwd) / \".claude\" / \"forge-state.json\"\n+    if not state_path.exists():\n+        return False\n+\n+    try:\n+        state = json.loads(state_path.read_text())\n+\n+        if \"lite_heavy_verification\" not in state:\n+            state[\"lite_heavy_verification\"] = {\n+                \"heavy_skill_read\": False,\n+                \"first_principles_launched\": False,\n+                \"agi_pilled_launched\": False,\n+            }\n+\n+        state[\"lite_heavy_verification\"].update(updates)\n+        state_path.write_text(json.dumps(state, indent=2))\n+        return True\n+    except (json.JSONDecodeError, OSError) as e:\n+        log_debug(f\"Failed to update lite heavy state: {e}\", hook_name=\"lite-heavy-tracker\")\n+        return False\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError:\n+      \n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}