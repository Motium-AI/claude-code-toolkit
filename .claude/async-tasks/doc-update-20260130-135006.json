{
  "type": "doc-update",
  "created_at": "2026-01-30T13:50:06.495144+00:00",
  "status": "pending",
  "commit_message": "refactor(hooks): split _common.py into 3 modules, remove broken PID-scoping\n\n- Split _common.py (1445 lines) into _common.py (290), _state.py (497),\n  _checkpoint.py (150) for clear separation of concerns\n- Remove 5 broken PID-scoping functions (_get_ancestor_pid, _scoped_filename,\n  _extract_pid_from_filename, _find_any_scoped_state_files, get_session_pid)\n  that caused infinite checkpoint loops on macOS\n- Multi-agent isolation now relies on git worktrees (separate .claude/ dirs)\n  instead of PID-scoped filenames within a single directory\n- Update imports in 18 hook files and 3 test files\n- Remove PID-scoped .gitignore patterns\n- Rename forge \u2192 build across skills, docs, harness tests, and scripts\n- All 112 tests pass, ruff clean\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 6307db7ca2066b271888c6466eec1bd29a76c2e4\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 14:50:06 2026 +0100\n\n    refactor(hooks): split _common.py into 3 modules, remove broken PID-scoping\n    \n    - Split _common.py (1445 lines) into _common.py (290), _state.py (497),\n      _checkpoint.py (150) for clear separation of concerns\n    - Remove 5 broken PID-scoping functions (_get_ancestor_pid, _scoped_filename,\n      _extract_pid_from_filename, _find_any_scoped_state_files, get_session_pid)\n      that caused infinite checkpoint loops on macOS\n    - Multi-agent isolation now relies on git worktrees (separate .claude/ dirs)\n      instead of PID-scoped filenames within a single directory\n    - Update imports in 18 hook files and 3 test files\n    - Remove PID-scoped .gitignore patterns\n    - Rename forge \u2192 build across skills, docs, harness tests, and scripts\n    - All 112 tests pass, ruff clean\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n .claude/MEMORIES.md                                |    2 +-\n .gitignore                                         |   16 +-\n QUICKSTART.md                                      |    6 +-\n README.md                                          |   10 +-\n config/commands/webtest.md                         |    4 +-\n config/hooks/README.md                             |    6 +-\n config/hooks/_checkpoint.py                        |  150 +++\n config/hooks/_common.py                            | 1206 +-------------------\n config/hooks/_state.py                             |  497 ++++++++\n config/hooks/_sv_validators.py                     |   23 +-\n config/hooks/auto-update.py                        |    8 +-\n config/hooks/bash-version-tracker.py               |    5 +-\n config/hooks/checkpoint-invalidator.py             |    5 +-\n config/hooks/deploy-enforcer.py                    |    4 +-\n config/hooks/deploy-verify.py                      |    2 +-\n config/hooks/doc-updater-async.py                  |   14 +-\n config/hooks/lite-heavy-enforcer.py                |   11 +-\n config/hooks/lite-heavy-tracker.py                 |   17 +-\n config/hooks/permissionrequest-auto-approve.py     |    8 +-\n config/hooks/plan-execution-reminder.py            |    2 +-\n config/hooks/plan-mode-enforcer.py                 |   13 +-\n config/hooks/plan-mode-tracker.py                  |    4 +-\n config/hooks/pretooluse-auto-approve.py            |    8 +-\n config/hooks/session-snapshot.py                   |   28 +-\n config/hooks/skill-continuation-reminder.py        |    8 +-\n config/hooks/skill-state-initializer.py            |   40 +-\n config/hooks/stop-validator.py                     |   14 +-\n config/hooks/tests/test_plan_mode_hooks.py         |   33 +-\n config/hooks/tests/test_sticky_session.py          |   51 +-\n config/hooks/tests/test_sv_validators.py           |   12 +-\n config/skills/appfix/SKILL.md                      |    2 +-\n config/skills/{forge => build}/SKILL.md            |   36 +-\n config/skills/harness-test/SKILL.md                |   16 +-\n .../harness-test/references/test-case-schema.md    |    6 +-\n .../skills/harness-test/scripts/detect-harness.sh  |   16 +-\n .../harness-test/scripts/propagate-changes.sh      |   10 +-\n .../skills/harness-test/scripts/run-all-tests.sh   |  147 ++-\n .../skills/harness-test/scripts/run-test-case.sh   |   34 +-\n .../harness-test/scripts/setup-harness-sandbox.sh  |   41 +-\n ...-mode.json => auto-approval-in-build-mode.json} |    4 +-\n .../test-cases/auto-approval-in-burndown-mode.json |   29 +\n .../plan-mode-enforcer-allows-claude-dir.json      |    2 +-\n .../plan-mode-enforcer-blocks-burndown.json        |   29 +\n .../plan-mode-enforcer-blocks-code-write.json      |    2 +-\n ...rge.json => skill-state-initializer-build.json} |    8 +-\n .../skill-state-initializer-burndown.json          |   21 +\n config/skills/repair/SKILL.md                      |    2 +-\n config/skills/skill-sandbox/SKILL.md               |    8 +-\n config/skills/skill-tester/scripts/test-skill.sh   |    4 +-\n config/skills/toolkit/SKILL.md                     |   36 +-\n .../toolkit/references/claude-md-optimizer.md      |    6 +-\n config/skills/webapp-testing/SKILL.md              |    8 +-\n docs/concepts/hooks.md                             |   24 +-\n docs/concepts/skills.md                            |    8 +-\n docs/hooks/azure-command-guard.md                  |    2 +-\n docs/hooks/azure-guard-testing.md                  |    4 +-\n docs/index.md                                      |   16 +-\n docs/skills/{forge-guide.md => build-guide.md}     |   22 +-\n scripts/doctor.sh                                  |   14 +-\n scripts/install.sh                                 |   46 +-\n 60 files changed, 1230 insertions(+), 1580 deletions(-)\n\ndiff --git a/.claude/MEMORIES.md b/.claude/MEMORIES.md\nindex aa51868..30588e4 100644\n--- a/.claude/MEMORIES.md\n+++ b/.claude/MEMORIES.md\n@@ -2,7 +2,7 @@\n \n ## Source of Truth\n \n-**This repo (`claude-code-toolkit`) is the source of truth for all skills, hooks, and configuration.**\n+**This repo (`halt`) is the source of truth for all skills, hooks, and configuration.**\n \n `~/.claude/skills/` and `~/.claude/hooks/` are symlinks to this repo's `config/` directory. When you edit skills or hooks (including via `~/.claude/`), you're editing this repo. **Always commit changes to preserve them.**\n \ndiff --git a/.gitignore b/.gitignore\nindex ec78fb1..6fb3066 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -4,11 +4,11 @@ __pycache__/\n *$py.class\n \n # Claude Code session state (transient files)\n-# Root level .claude/ \u2014 legacy unscoped files\n .claude/completion-checkpoint.json\n .claude/session-snapshot.json\n .claude/appfix-state.json\n .claude/forge-state.json\n+.claude/build-state.json\n .claude/burndown-state.json\n .claude/godo-state.json\n .claude/session-owner.json\n@@ -17,28 +17,16 @@ __pycache__/\n .claude/validation-tests/\n .claude/toolkit-update-state.json\n \n-# PID-scoped session state files (e.g., forge-state.12345.json)\n-.claude/forge-state.*.json\n-.claude/appfix-state.*.json\n-.claude/burndown-state.*.json\n-.claude/completion-checkpoint.*.json\n-.claude/session-snapshot.*.json\n-\n # Nested .claude/ directories (e.g., config/hooks/.claude/)\n **/.claude/completion-checkpoint.json\n **/.claude/session-snapshot.json\n **/.claude/appfix-state.json\n **/.claude/forge-state.json\n+**/.claude/build-state.json\n **/.claude/burndown-state.json\n **/.claude/godo-state.json\n **/.claude/session-owner.json\n **/.claude/web-smoke/\n-# Nested PID-scoped files\n-**/.claude/forge-state.*.json\n-**/.claude/appfix-state.*.json\n-**/.claude/burndown-state.*.json\n-**/.claude/completion-checkpoint.*.json\n-**/.claude/session-snapshot.*.json\n \n # OS\n .DS_Store\ndiff --git a/QUICKSTART.md b/QUICKSTART.md\nindex de712da..7bbfe9d 100644\n--- a/QUICKSTART.md\n+++ b/QUICKSTART.md\n@@ -10,8 +10,8 @@\n ## Install\n \n ```bash\n-git clone https://github.com/Motium-AI/claude-code-toolkit.git\n-cd claude-code-toolkit\n+git clone https://github.com/Motium-AI/halt.git\n+cd halt\n ./scripts/install.sh\n ```\n \n@@ -63,7 +63,7 @@ ls -la ~/.claude/  # Check symlinks\n \n ### Auto-approval not working\n ```bash\n-cat .claude/appfix-state.json  # Should exist during /godo or /appfix\n+cat .claude/appfix-state.json  # Should exist during /build or /appfix\n ```\n \n ### Debug log\ndiff --git a/README.md b/README.md\nindex b095e20..bb8022a 100644\n--- a/README.md\n+++ b/README.md\n@@ -1,4 +1,4 @@\n-# Claude Code Toolkit\n+# Halt\n \n **The agent that actually finishes.**\n \n@@ -7,13 +7,13 @@ Claude Code stops when *you* hit enter. This toolkit adds a stop hook that block\n ## Try It (60 seconds)\n \n ```bash\n-git clone https://github.com/Motium-AI/claude-code-toolkit.git\n-cd claude-code-toolkit && ./scripts/install.sh\n+git clone https://github.com/Motium-AI/halt.git\n+cd halt && ./scripts/install.sh\n # Restart Claude Code, then:\n ```\n \n ```\n-> /forge add a logout button to the navbar\n+> /build add a logout button to the na\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/index.md",
    "docs/philosophy.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an repair/build session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nrefactor(hooks): split _common.py into 3 modules, remove broken PID-scoping\n\n- Split _common.py (1445 lines) into _common.py (290), _state.py (497),\n  _checkpoint.py (150) for clear separation of concerns\n- Remove 5 broken PID-scoping functions (_get_ancestor_pid, _scoped_filename,\n  _extract_pid_from_filename, _find_any_scoped_state_files, get_session_pid)\n  that caused infinite checkpoint loops on macOS\n- Multi-agent isolation now relies on git worktrees (separate .claude/ dirs)\n  instead of PID-scoped filenames within a single directory\n- Update imports in 18 hook files and 3 test files\n- Remove PID-scoped .gitignore patterns\n- Rename forge \u2192 build across skills, docs, harness tests, and scripts\n- All 112 tests pass, ruff clean\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/index.md\n- docs/philosophy.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 6307db7ca2066b271888c6466eec1bd29a76c2e4\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 14:50:06 2026 +0100\n\n    refactor(hooks): split _common.py into 3 modules, remove broken PID-scoping\n    \n    - Split _common.py (1445 lines) into _common.py (290), _state.py (497),\n      _checkpoint.py (150) for clear separation of concerns\n    - Remove 5 broken PID-scoping functions (_get_ancestor_pid, _scoped_filename,\n      _extract_pid_from_filename, _find_any_scoped_state_files, get_session_pid)\n      that caused infinite checkpoint loops on macOS\n    - Multi-agent isolation now relies on git worktrees (separate .claude/ dirs)\n      instead of PID-scoped filenames within a single directory\n    - Update imports in 18 hook files and 3 test files\n    - Remove PID-scoped .gitignore patterns\n    - Rename forge \u2192 build across skills, docs, harness tests, and scripts\n    - All 112 tests pass, ruff clean\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n .claude/MEMORIES.md                                |    2 +-\n .gitignore                                         |   16 +-\n QUICKSTART.md                                      |    6 +-\n README.md                                          |   10 +-\n config/commands/webtest.md                         |    4 +-\n config/hooks/README.md                             |    6 +-\n config/hooks/_checkpoint.py                        |  150 +++\n config/hooks/_common.py                            | 1206 +-------------------\n config/hooks/_state.py                             |  497 ++++++++\n config/hooks/_sv_validators.py                     |   23 +-\n config/hooks/auto-update.py                        |    8 +-\n config/hooks/bash-version-tracker.py               |    5 +-\n config/hooks/checkpoint-invalidator.py             |    5 +-\n config/hooks/deploy-enforcer.py                    |    4 +-\n config/hooks/deploy-verify.py                      |    2 +-\n config/hooks/doc-updater-async.py                  |   14 +-\n config/hooks/lite-heavy-enforcer.py                |   11 +-\n config/hooks/lite-heavy-tracker.py                 |   17 +-\n config/hooks/permissionrequest-auto-approve.py     |    8 +-\n config/hooks/plan-execution-reminder.py            |    2 +-\n config/hooks/plan-mode-enforcer.py                 |   13 +-\n config/hooks/plan-mode-tracker.py                  |    4 +-\n config/hooks/pretooluse-auto-approve.py            |    8 +-\n config/hooks/session-snapshot.py                   |   28 +-\n config/hooks/skill-continuation-reminder.py        |    8 +-\n config/hooks/skill-state-initializer.py            |   40 +-\n config/hooks/stop-validator.py                     |   14 +-\n config/hooks/tests/test_plan_mode_hooks.py         |   33 +-\n config/hooks/tests/test_sticky_session.py          |   51 +-\n config/hooks/tests/test_sv_validators.py           |   12 +-\n config/skills/appfix/SKILL.md                      |    2 +-\n config/skills/{forge => build}/SKILL.md            |   36 +-\n config/skills/harness-test/SKILL.md                |   16 +-\n .../harness-test/references/test-case-schema.md    |    6 +-\n .../skills/harness-test/scripts/detect-harness.sh  |   16 +-\n .../harness-test/scripts/propagate-changes.sh      |   10 +-\n .../skills/harness-test/scripts/run-all-tests.sh   |  147 ++-\n .../skills/harness-test/scripts/run-test-case.sh   |   34 +-\n .../harness-test/scripts/setup-harness-sandbox.sh  |   41 +-\n ...-mode.json => auto-approval-in-build-mode.json} |    4 +-\n .../test-cases/auto-approval-in-burndown-mode.json |   29 +\n .../plan-mode-enforcer-allows-claude-dir.json      |    2 +-\n .../plan-mode-enforcer-blocks-burndown.json        |   29 +\n .../plan-mode-enforcer-blocks-code-write.json      |    2 +-\n ...rge.json => skill-state-initializer-build.json} |    8 +-\n .../skill-state-initializer-burndown.json          |   21 +\n config/skills/repair/SKILL.md                      |    2 +-\n config/skills/skill-sandbox/SKILL.md               |    8 +-\n config/skills/skill-tester/scripts/test-skill.sh   |    4 +-\n config/skills/toolkit/SKILL.md                     |   36 +-\n .../toolkit/references/claude-md-optimizer.md      |    6 +-\n config/skills/webapp-testing/SKILL.md              |    8 +-\n docs/concepts/hooks.md                             |   24 +-\n docs/concepts/skills.md                            |    8 +-\n docs/hooks/azure-command-guard.md                  |    2 +-\n docs/hooks/azure-guard-testing.md                  |    4 +-\n docs/index.md                                      |   16 +-\n docs/skills/{forge-guide.md => build-guide.md}     |   22 +-\n scripts/doctor.sh                                  |   14 +-\n scripts/install.sh                                 |   46 +-\n 60 files changed, 1230 insertions(+), 1580 deletions(-)\n\ndiff --git a/.claude/MEMORIES.md b/.claude/MEMORIES.md\nindex aa51868..30588e4 100644\n--- a/.claude/MEMORIES.md\n+++ b/.claude/MEMORIES.md\n@@ -2,7 +2,7 @@\n \n ## Source of Truth\n \n-**This repo (`claude-code-toolkit`) is the source of truth for all skills, hooks, and configuration.**\n+**This repo (`halt`) is the source of truth for all skills, hooks, and configuration.**\n \n `~/.claude/skills/` and `~/.claude/hooks/` are symlinks to this repo's `config/` directory. When you edit skills or hooks (including via `~/.claude/`), you're editing this repo. **Always commit changes to preserve them.**\n \ndiff --git a/.gitignore b/.gitignore\nindex ec78fb1..6fb3066 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -4,11 +4,11 @@ __pycache__/\n *$py.class\n \n # Claude Code session state (transient files)\n-# Root level .claude/ \u2014 legacy unscoped files\n .claude/completion-checkpoint.json\n .claude/session-snapshot.json\n .claude/appfix-state.json\n .claude/forge-state.json\n+.claude/build-state.json\n .claude/burndown-state.json\n .claude/godo-state.json\n .claude/session-owner.json\n@@ -17,28 +17,16 @@ __pycache__/\n .claude/validation-tests/\n .claude/toolkit-update-state.json\n \n-# PID-scoped session state files (e.g., forge-state.12345.json)\n-.claude/forge-state.*.json\n-.claude/appfix-state.*.json\n-.claude/burndown-state.*.json\n-.claude/completion-checkpoint.*.json\n-.claude/session-snapshot.*.json\n-\n # Nested .claude/ directories (e.g., config/hooks/.claude/)\n **/.claude/completion-checkpoint.json\n **/.claude/session-snapshot.json\n **/.claude/appfix-state.json\n **/.claude/forge-state.json\n+**/.claude/build-state.json\n **/.claude/burndown-state.json\n **/.claude/godo-state.json\n **/.claude/session-owner.json\n **/.claude/web-smoke/\n-# Nested PID-scoped files\n-**/.claude/forge-state.*.json\n-**/.claude/appfix-state.*.json\n-**/.claude/burndown-state.*.json\n-**/.claude/completion-checkpoint.*.json\n-**/.claude/session-snapshot.*.json\n \n # OS\n .DS_Store\ndiff --git a/QUICKSTART.md b/QUICKSTART.md\nindex de712da..7bbfe9d 100644\n--- a/QUICKSTART.md\n+++ b/QUICKSTART.md\n@@ -10,8 +10,8 @@\n ## Install\n \n ```bash\n-git clone https://github.com/Motium-AI/claude-code-toolkit.git\n-cd claude-code-toolkit\n+git clone https://github.com/Motium-AI/halt.git\n+cd halt\n ./scripts/install.sh\n ```\n \n@@ -63,7 +63,7 @@ ls -la ~/.claude/  # Check symlinks\n \n ### Auto-approval not working\n ```bash\n-cat .claude/appfix-state.json  # Should exist during /godo or /appfix\n+cat .claude/appfix-state.json  # Should exist during /build or /appfix\n ```\n \n ### Debug log\ndiff --git a/README.md b/README.md\nindex b095e20..bb8022a 100644\n--- a/README.md\n+++ b/README.md\n@@ -1,4 +1,4 @@\n-# Claude Code Toolkit\n+# Halt\n \n **The agent that actually finishes.**\n \n@@ -7,13 +7,13 @@ Claude Code stops when *you* hit enter. This toolkit adds a stop hook that block\n ## Try It (60 seconds)\n \n ```bash\n-git clone https://github.com/Motium-AI/claude-code-toolkit.git\n-cd claude-code-toolkit && ./scripts/install.sh\n+git clone https://github.com/Motium-AI/halt.git\n+cd halt && ./scripts/install.sh\n # Restart Claude Code, then:\n ```\n \n ```\n-> /forge add a logout button to the navbar\n+> /build add a logout button to the na\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}