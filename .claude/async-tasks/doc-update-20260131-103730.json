{
  "type": "doc-update",
  "created_at": "2026-01-31T10:37:30.062148+00:00",
  "status": "pending",
  "commit_message": "feat(go): redesign /go with Read-gate, 3+1 validation, task-agnostic design\n\nAdd Read-gated editing (blocks Edit/Write until Read/Grep/Glob used),\nreplace 2-field checkpoint with 3+1 schema (is_job_complete + what_remains +\nwhat_was_done >20 chars + conditional linters_pass), make /go task-agnostic\n(code/docs/config/research), add mutual exclusion between /go and /build\nstate files, and add implementation intention prompt in SKILL.md.\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 720358730a9c23ee816cdb882a5b9be9253bbeb5\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Sat Jan 31 11:37:29 2026 +0100\n\n    feat(go): redesign /go with Read-gate, 3+1 validation, task-agnostic design\n    \n    Add Read-gated editing (blocks Edit/Write until Read/Grep/Glob used),\n    replace 2-field checkpoint with 3+1 schema (is_job_complete + what_remains +\n    what_was_done >20 chars + conditional linters_pass), make /go task-agnostic\n    (code/docs/config/research), add mutual exclusion between /go and /build\n    state files, and add implementation intention prompt in SKILL.md.\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/_state.py                      |   5 +-\n config/hooks/_sv_templates.py               |  40 +++++++++\n config/hooks/_sv_validators.py              |  36 +++++++-\n config/hooks/go-context-tracker.py          |  62 +++++++++++++\n config/hooks/plan-mode-enforcer.py          |  17 ++++\n config/hooks/skill-continuation-reminder.py |   5 +-\n config/hooks/skill-state-initializer.py     |  17 ++++\n config/settings.json                        |  25 ++++++\n config/skills/go/SKILL.md                   | 131 ++++++++++++----------------\n docs/index.md                               |   7 +-\n 10 files changed, 260 insertions(+), 85 deletions(-)\n\ndiff --git a/config/hooks/_state.py b/config/hooks/_state.py\nindex 3c9afb7..ea30896 100644\n--- a/config/hooks/_state.py\n+++ b/config/hooks/_state.py\n@@ -547,7 +547,10 @@ def reset_state_for_next_task(cwd: str) -> bool:\n                 state = json.loads(state_path.read_text())\n                 state[\"iteration\"] = state.get(\"iteration\", 1) + 1\n                 # /go mode keeps plan_mode_completed=True (skips planning by design)\n-                if filename != \"go-state.json\":\n+                # but must re-read for each new task (Read-gate resets)\n+                if filename == \"go-state.json\":\n+                    state[\"context_gathered\"] = False\n+                else:\n                     state[\"plan_mode_completed\"] = False\n                 state[\"verification_evidence\"] = None\n                 state[\"services\"] = {}\ndiff --git a/config/hooks/_sv_templates.py b/config/hooks/_sv_templates.py\nindex 9eaa25e..fa625b7 100644\n--- a/config/hooks/_sv_templates.py\n+++ b/config/hooks/_sv_templates.py\n@@ -15,12 +15,26 @@ from pathlib import Path\n sys.path.insert(0, str(Path(__file__).parent))\n \n from _common import get_code_version, get_worktree_info\n+from _state import is_go_active\n \n \n # ============================================================================\n # Template Constants\n # ============================================================================\n \n+GO_CHECKPOINT_SCHEMA_TEMPLATE = \"\"\"{version_note}\n+{{\n+  \"self_report\": {{\n+    \"is_job_complete\": false,                // Is the job ACTUALLY done?\n+    \"code_changes_made\": false,              // Did you modify any code files?\n+    \"linters_pass\": false                    // (Only if code_changes_made) Did linters pass?\n+  }},\n+  \"reflection\": {{\n+    \"what_was_done\": \"...\",                  // >20 chars - what you actually did\n+    \"what_remains\": \"none\"                   // Must be empty to allow stop\n+  }}\n+}}\"\"\"\n+\n CHECKPOINT_SCHEMA_TEMPLATE = \"\"\"{version_note}\n {{\n   \"self_report\": {{\n@@ -107,6 +121,32 @@ def block_no_checkpoint(cwd: str) -> None:\n         f\"// Current version: {current_version}\" if current_version != \"unknown\" else \"\"\n     )\n \n+    # Use GO-specific lightweight template when /go is active\n+    if is_go_active(cwd):\n+        schema = GO_CHECKPOINT_SCHEMA_TEMPLATE.format(version_note=version_note)\n+        print(\n+            f\"\"\"\n+\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n+\u2551  \u274c COMPLETION CHECKPOINT REQUIRED (/go)                                      \u2551\n+\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n+\n+You must create {checkpoint_path} before stopping.\n+\n+/go uses a lightweight 3+1 checkpoint:\n+\n+{schema}\n+\n+RULES:\n+- what_was_done must be >20 characters (describe what you did)\n+- what_remains must be empty (\"none\") to stop\n+- linters_pass only required if you changed code files (code_changes_made: true)\n+\n+Create this file, answer honestly, then stop again.\n+\"\"\",\n+            file=sys.stderr,\n+        )\n+        sys.exit(2)\n+\n     schema = CHECKPOINT_SCHEMA_TEMPLATE.format(version_note=version_note)\n \n     print(\ndiff --git a/config/hooks/_sv_validators.py b/config/hooks/_sv_validators.py\nindex 09c8715..9d83401 100644\n--- a/config/hooks/_sv_validators.py\n+++ b/config/hooks/_sv_validators.py\n@@ -555,6 +555,35 @@ def validate_core_completion(report: dict, reflection: dict) -> list[str]:\n     return failures\n \n \n+def validate_go_completion(report: dict, reflection: dict) -> list[str]:\n+    \"\"\"Validate /go mode checkpoint: 3+1 fields.\n+\n+    Always required: is_job_complete, what_remains empty, what_was_done >20 chars.\n+    Conditional: linters_pass required only when code_changes_made is self-reported true.\n+    \"\"\"\n+    failures = []\n+\n+    # Core completion (is_job_complete + what_remains)\n+    failures.extend(validate_core_completion(report, reflection))\n+\n+    # what_was_done must be substantive (>20 chars)\n+    what_done = reflection.get(\"what_was_done\", \"\")\n+    if not what_done or len(what_done.strip()) < 20:\n+        failures.append(\n+            \"what_was_done is missing or too brief (need >20 chars) - \"\n+            \"describe what you actually did\"\n+        )\n+\n+    # Conditional: linters_pass only when code was changed\n+    if report.get(\"code_changes_made\", False):\n+        if not report.get(\"linters_pass\", False):\n+            failures.append(\n+                \"linters_pass required - you changed code, run the linter\"\n+            )\n+\n+    return failures\n+\n+\n def validate_code_requirements(\n     report: dict, has_app_code: bool, has_frontend: bool\n ) -> list[str]:\n@@ -797,10 +826,11 @@ def validate_checkpoint(\n     report = checkpoint.get(\"self_report\", {})\n     reflection = checkpoint.get(\"reflection\", {})\n \n-    # FAST PATH: /go mode uses simplified validation\n-    # Only checks is_job_complete and what_remains\n+    # FAST PATH: /go mode uses 3+1 validation\n+    # Core: is_job_complete, what_remains, what_was_done >20 chars\n+    # Conditional: linters_pass when code_changes_made is true\n     if is_go_active(cwd):\n-        failures.extend(validate_core_completion(report, reflection))\n+        failures.extend(validate_go_completion(report, reflection))\n         return len(failures) == 0, failures\n     checkpoint_modified = False\n \ndiff --git a/config/hooks/go-context-tracker.py b/config/hooks/go-context-tracker.py\nnew file mode 100644\nindex 0000000..1d76dcd\n--- /dev/null\n+++ b/config/hooks/go-context-tracker.py\n@@ -0,0 +1,62 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PostToolUse hook that tracks context gathering for /go mode Read-gate.\n+\n+When /go is active and context_gathered is False, this hook flips it to True\n+after Read, Grep, or Glob tools are used. This unlocks the Read-gate in\n+plan-mode-enforcer.py, allowing Edit/Write to proceed.\n+\n+Only fires on iteration 1 (first task in session). Subsequent tasks also\n+need to re-read before editing (context_gathered resets per task).\n+\n+Hook event: PostToolUse\n+Matcher: Read, Grep, Glob\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import log_debug\n+from _state import is_go_active, load_state_file, update_state_file\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError:\n+        sys.exit(0)\n+\n+    tool_name = input_data.get(\"tool_name\", \"\")\n+    cwd = input_data.get(\"cwd\", \"\") or os.getcwd()\n+\n+    if tool_name not in (\"Read\", \"Grep\", \"Glob\"):\n+        sys.exit(0)\n+\n+    if not is_go_active(cwd):\n+        sys.exit(0)\n+\n+    state = load_state_f\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/analysis-persistent-memory-for-harnesses.md",
    "docs/index.md",
    "docs/memory-integration-analysis.md",
    "docs/philosophy.md",
    "docs/audiobook-the-amnesiac-architect.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an repair/build session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nfeat(go): redesign /go with Read-gate, 3+1 validation, task-agnostic design\n\nAdd Read-gated editing (blocks Edit/Write until Read/Grep/Glob used),\nreplace 2-field checkpoint with 3+1 schema (is_job_complete + what_remains +\nwhat_was_done >20 chars + conditional linters_pass), make /go task-agnostic\n(code/docs/config/research), add mutual exclusion between /go and /build\nstate files, and add implementation intention prompt in SKILL.md.\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/analysis-persistent-memory-for-harnesses.md\n- docs/index.md\n- docs/memory-integration-analysis.md\n- docs/philosophy.md\n- docs/audiobook-the-amnesiac-architect.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 720358730a9c23ee816cdb882a5b9be9253bbeb5\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Sat Jan 31 11:37:29 2026 +0100\n\n    feat(go): redesign /go with Read-gate, 3+1 validation, task-agnostic design\n    \n    Add Read-gated editing (blocks Edit/Write until Read/Grep/Glob used),\n    replace 2-field checkpoint with 3+1 schema (is_job_complete + what_remains +\n    what_was_done >20 chars + conditional linters_pass), make /go task-agnostic\n    (code/docs/config/research), add mutual exclusion between /go and /build\n    state files, and add implementation intention prompt in SKILL.md.\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/_state.py                      |   5 +-\n config/hooks/_sv_templates.py               |  40 +++++++++\n config/hooks/_sv_validators.py              |  36 +++++++-\n config/hooks/go-context-tracker.py          |  62 +++++++++++++\n config/hooks/plan-mode-enforcer.py          |  17 ++++\n config/hooks/skill-continuation-reminder.py |   5 +-\n config/hooks/skill-state-initializer.py     |  17 ++++\n config/settings.json                        |  25 ++++++\n config/skills/go/SKILL.md                   | 131 ++++++++++++----------------\n docs/index.md                               |   7 +-\n 10 files changed, 260 insertions(+), 85 deletions(-)\n\ndiff --git a/config/hooks/_state.py b/config/hooks/_state.py\nindex 3c9afb7..ea30896 100644\n--- a/config/hooks/_state.py\n+++ b/config/hooks/_state.py\n@@ -547,7 +547,10 @@ def reset_state_for_next_task(cwd: str) -> bool:\n                 state = json.loads(state_path.read_text())\n                 state[\"iteration\"] = state.get(\"iteration\", 1) + 1\n                 # /go mode keeps plan_mode_completed=True (skips planning by design)\n-                if filename != \"go-state.json\":\n+                # but must re-read for each new task (Read-gate resets)\n+                if filename == \"go-state.json\":\n+                    state[\"context_gathered\"] = False\n+                else:\n                     state[\"plan_mode_completed\"] = False\n                 state[\"verification_evidence\"] = None\n                 state[\"services\"] = {}\ndiff --git a/config/hooks/_sv_templates.py b/config/hooks/_sv_templates.py\nindex 9eaa25e..fa625b7 100644\n--- a/config/hooks/_sv_templates.py\n+++ b/config/hooks/_sv_templates.py\n@@ -15,12 +15,26 @@ from pathlib import Path\n sys.path.insert(0, str(Path(__file__).parent))\n \n from _common import get_code_version, get_worktree_info\n+from _state import is_go_active\n \n \n # ============================================================================\n # Template Constants\n # ============================================================================\n \n+GO_CHECKPOINT_SCHEMA_TEMPLATE = \"\"\"{version_note}\n+{{\n+  \"self_report\": {{\n+    \"is_job_complete\": false,                // Is the job ACTUALLY done?\n+    \"code_changes_made\": false,              // Did you modify any code files?\n+    \"linters_pass\": false                    // (Only if code_changes_made) Did linters pass?\n+  }},\n+  \"reflection\": {{\n+    \"what_was_done\": \"...\",                  // >20 chars - what you actually did\n+    \"what_remains\": \"none\"                   // Must be empty to allow stop\n+  }}\n+}}\"\"\"\n+\n CHECKPOINT_SCHEMA_TEMPLATE = \"\"\"{version_note}\n {{\n   \"self_report\": {{\n@@ -107,6 +121,32 @@ def block_no_checkpoint(cwd: str) -> None:\n         f\"// Current version: {current_version}\" if current_version != \"unknown\" else \"\"\n     )\n \n+    # Use GO-specific lightweight template when /go is active\n+    if is_go_active(cwd):\n+        schema = GO_CHECKPOINT_SCHEMA_TEMPLATE.format(version_note=version_note)\n+        print(\n+            f\"\"\"\n+\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n+\u2551  \u274c COMPLETION CHECKPOINT REQUIRED (/go)                                      \u2551\n+\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n+\n+You must create {checkpoint_path} before stopping.\n+\n+/go uses a lightweight 3+1 checkpoint:\n+\n+{schema}\n+\n+RULES:\n+- what_was_done must be >20 characters (describe what you did)\n+- what_remains must be empty (\"none\") to stop\n+- linters_pass only required if you changed code files (code_changes_made: true)\n+\n+Create this file, answer honestly, then stop again.\n+\"\"\",\n+            file=sys.stderr,\n+        )\n+        sys.exit(2)\n+\n     schema = CHECKPOINT_SCHEMA_TEMPLATE.format(version_note=version_note)\n \n     print(\ndiff --git a/config/hooks/_sv_validators.py b/config/hooks/_sv_validators.py\nindex 09c8715..9d83401 100644\n--- a/config/hooks/_sv_validators.py\n+++ b/config/hooks/_sv_validators.py\n@@ -555,6 +555,35 @@ def validate_core_completion(report: dict, reflection: dict) -> list[str]:\n     return failures\n \n \n+def validate_go_completion(report: dict, reflection: dict) -> list[str]:\n+    \"\"\"Validate /go mode checkpoint: 3+1 fields.\n+\n+    Always required: is_job_complete, what_remains empty, what_was_done >20 chars.\n+    Conditional: linters_pass required only when code_changes_made is self-reported true.\n+    \"\"\"\n+    failures = []\n+\n+    # Core completion (is_job_complete + what_remains)\n+    failures.extend(validate_core_completion(report, reflection))\n+\n+    # what_was_done must be substantive (>20 chars)\n+    what_done = reflection.get(\"what_was_done\", \"\")\n+    if not what_done or len(what_done.strip()) < 20:\n+        failures.append(\n+            \"what_was_done is missing or too brief (need >20 chars) - \"\n+            \"describe what you actually did\"\n+        )\n+\n+    # Conditional: linters_pass only when code was changed\n+    if report.get(\"code_changes_made\", False):\n+        if not report.get(\"linters_pass\", False):\n+            failures.append(\n+                \"linters_pass required - you changed code, run the linter\"\n+            )\n+\n+    return failures\n+\n+\n def validate_code_requirements(\n     report: dict, has_app_code: bool, has_frontend: bool\n ) -> list[str]:\n@@ -797,10 +826,11 @@ def validate_checkpoint(\n     report = checkpoint.get(\"self_report\", {})\n     reflection = checkpoint.get(\"reflection\", {})\n \n-    # FAST PATH: /go mode uses simplified validation\n-    # Only checks is_job_complete and what_remains\n+    # FAST PATH: /go mode uses 3+1 validation\n+    # Core: is_job_complete, what_remains, what_was_done >20 chars\n+    # Conditional: linters_pass when code_changes_made is true\n     if is_go_active(cwd):\n-        failures.extend(validate_core_completion(report, reflection))\n+        failures.extend(validate_go_completion(report, reflection))\n         return len(failures) == 0, failures\n     checkpoint_modified = False\n \ndiff --git a/config/hooks/go-context-tracker.py b/config/hooks/go-context-tracker.py\nnew file mode 100644\nindex 0000000..1d76dcd\n--- /dev/null\n+++ b/config/hooks/go-context-tracker.py\n@@ -0,0 +1,62 @@\n+#!/usr/bin/env python3\n+\"\"\"\n+PostToolUse hook that tracks context gathering for /go mode Read-gate.\n+\n+When /go is active and context_gathered is False, this hook flips it to True\n+after Read, Grep, or Glob tools are used. This unlocks the Read-gate in\n+plan-mode-enforcer.py, allowing Edit/Write to proceed.\n+\n+Only fires on iteration 1 (first task in session). Subsequent tasks also\n+need to re-read before editing (context_gathered resets per task).\n+\n+Hook event: PostToolUse\n+Matcher: Read, Grep, Glob\n+\"\"\"\n+\n+from __future__ import annotations\n+\n+import json\n+import os\n+import sys\n+from pathlib import Path\n+\n+sys.path.insert(0, str(Path(__file__).parent))\n+from _common import log_debug\n+from _state import is_go_active, load_state_file, update_state_file\n+\n+\n+def main():\n+    try:\n+        input_data = json.load(sys.stdin)\n+    except json.JSONDecodeError:\n+        sys.exit(0)\n+\n+    tool_name = input_data.get(\"tool_name\", \"\")\n+    cwd = input_data.get(\"cwd\", \"\") or os.getcwd()\n+\n+    if tool_name not in (\"Read\", \"Grep\", \"Glob\"):\n+        sys.exit(0)\n+\n+    if not is_go_active(cwd):\n+        sys.exit(0)\n+\n+    state = load_state_f\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}