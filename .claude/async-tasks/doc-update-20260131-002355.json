{
  "type": "doc-update",
  "created_at": "2026-01-31T00:23:55.207868+00:00",
  "status": "pending",
  "commit_message": "feat(compound): add /compound skill for cross-session knowledge capture\n\nImplements Phase 1 and 1.5 of the Compound Memory System:\n\nPhase 1 - /compound skill:\n- config/skills/compound/SKILL.md: Structured knowledge capture workflow\n- config/skills/compound/references/solution-schema.md: Controlled vocabulary\n  (11 problem types, 16 root causes, 10 resolution types, 4 severity levels)\n- docs/solutions/: Knowledge base directory with category subdirectories\n\nPhase 1.5 - Retrieval integration:\n- config/skills/build/SKILL.md: Added past solutions search to Phase 0.5\n  planning (grep docs/solutions/ for task keywords)\n\nDesigned based on 7-agent /heavy analysis:\n- Filesystem agents outperform vector DBs (Letta 2026: 74% vs 68.5%)\n- Manual trigger for quality control\n- Local-first, no cloud dependencies\n- ~225 lines total\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 36fa2eb4d308c2e46915072967bfa712e0d6474c\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Sat Jan 31 01:23:55 2026 +0100\n\n    feat(compound): add /compound skill for cross-session knowledge capture\n    \n    Implements Phase 1 and 1.5 of the Compound Memory System:\n    \n    Phase 1 - /compound skill:\n    - config/skills/compound/SKILL.md: Structured knowledge capture workflow\n    - config/skills/compound/references/solution-schema.md: Controlled vocabulary\n      (11 problem types, 16 root causes, 10 resolution types, 4 severity levels)\n    - docs/solutions/: Knowledge base directory with category subdirectories\n    \n    Phase 1.5 - Retrieval integration:\n    - config/skills/build/SKILL.md: Added past solutions search to Phase 0.5\n      planning (grep docs/solutions/ for task keywords)\n    \n    Designed based on 7-agent /heavy analysis:\n    - Filesystem agents outperform vector DBs (Letta 2026: 74% vs 68.5%)\n    - Manual trigger for quality control\n    - Local-first, no cloud dependencies\n    - ~225 lines total\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/skills/build/SKILL.md                       |   6 +\n config/skills/compound/SKILL.md                    | 240 +++++++++++++++++++++\n .../skills/compound/references/solution-schema.md  | 114 ++++++++++\n docs/index.md                                      |   4 +-\n docs/solutions/.gitkeep                            |  44 ++++\n 5 files changed, 407 insertions(+), 1 deletion(-)\n\ndiff --git a/config/skills/build/SKILL.md b/config/skills/build/SKILL.md\nindex c87f48c..8d01f72 100644\n--- a/config/skills/build/SKILL.md\n+++ b/config/skills/build/SKILL.md\n@@ -320,6 +320,12 @@ Lite Heavy is a streamlined version of `/heavy` that provides multi-perspective\n    - Environment and deployment configs\n    - Relevant code patterns for the task\n    - Existing tests and validation\n+   - **Past solutions** (if `docs/solutions/` exists):\n+     ```bash\n+     grep -riwl \"{task-keyword}\" docs/solutions/\n+     ```\n+     Read any matching files \u2014 they contain root causes, failed attempts,\n+     and prevention guidance from previous sessions.\n \n 3. **Read `/heavy` agent prompts and generate dynamic perspectives**:\n \ndiff --git a/config/skills/compound/SKILL.md b/config/skills/compound/SKILL.md\nnew file mode 100644\nindex 0000000..2383154\n--- /dev/null\n+++ b/config/skills/compound/SKILL.md\n@@ -0,0 +1,240 @@\n+---\n+name: compound\n+description: Capture solved problems as structured markdown for cross-session learning. Use when you've solved a non-trivial problem and want future sessions to benefit. Triggers on \"/compound\", \"document this solution\", \"capture this learning\".\n+---\n+\n+# Knowledge Capture (/compound)\n+\n+Capture solved problems as structured markdown with YAML frontmatter. Creates searchable solution documents that future sessions can reference during planning.\n+\n+## When to Use\n+\n+- After debugging a non-trivial issue\n+- After discovering a platform-specific gotcha\n+- After finding a root cause that wasn't obvious\n+- After trying multiple approaches and finding one that works\n+- After making an architectural decision with rationale\n+\n+**Quality gate**: This is manual trigger by design. Not every fix deserves permanent documentation. Use `/compound` when the learning would save time in future sessions.\n+\n+## Triggers\n+\n+- `/compound`\n+- \"document this solution\"\n+- \"capture this learning\"\n+- \"remember this fix\"\n+\n+## Workflow\n+\n+### Step 1: Extract Context from Current Session\n+\n+Review the current session to identify:\n+\n+1. **Problem**: What was broken or unclear?\n+2. **Symptoms**: What did the user or system observe?\n+3. **Investigation**: What did you try?\n+4. **What Didn't Work**: Failed approaches and why\n+5. **Root Cause**: The actual underlying issue\n+6. **Solution**: What fixed it\n+7. **Prevention**: How to avoid this in future\n+\n+### Step 2: Classify with Schema\n+\n+Read `~/.claude/skills/compound/references/solution-schema.md` for the controlled vocabulary.\n+\n+Select:\n+- **problem_type**: One of 11 types (maps to category directory)\n+- **root_cause**: One of 16 causes\n+- **resolution_type**: One of 10 types\n+- **severity**: critical, high, medium, low\n+- **tags**: 3-7 searchable keywords\n+\n+### Step 3: Generate File Path\n+\n+```\n+docs/solutions/{category}/{slug}-{YYYYMMDD}.md\n+```\n+\n+| problem_type | category directory |\n+|--------------|-------------------|\n+| build_error | build-errors |\n+| test_failure | test-failures |\n+| runtime_error | runtime-errors |\n+| performance_issue | performance |\n+| config_error | config-errors |\n+| dependency_issue | dependencies |\n+| integration_issue | integrations |\n+| logic_error | logic-errors |\n+| design_flaw | design-flaws |\n+| infrastructure_issue | infrastructure |\n+| security_issue | security |\n+\n+**Slug format**: lowercase-hyphenated summary of the problem (max 50 chars)\n+\n+### Step 4: Write Solution Document\n+\n+```markdown\n+---\n+title: \"{Concise problem description}\"\n+date: {YYYY-MM-DD}\n+problem_type: {from schema}\n+component: \"{file or module affected}\"\n+root_cause: {from schema}\n+resolution_type: {from schema}\n+severity: {critical|high|medium|low}\n+symptoms:\n+  - \"{Observable symptom 1}\"\n+  - \"{Observable symptom 2}\"\n+tags: [{keyword1}, {keyword2}, {keyword3}]\n+---\n+\n+# {Title}\n+\n+## Problem\n+\n+{1-3 sentences describing what was broken or unclear}\n+\n+## Symptoms\n+\n+- {What the user or system observed}\n+- {Error messages if any}\n+- {Unexpected behavior}\n+\n+## What Didn't Work\n+\n+**Attempt 1:** {What you tried}\n+- Why it failed: {Explanation}\n+\n+**Attempt 2:** {What you tried}\n+- Why it failed: {Explanation}\n+\n+## Root Cause\n+\n+{2-5 sentences explaining the actual underlying issue}\n+\n+## Solution\n+\n+{Description of what fixed it}\n+\n+```{language}\n+{Code snippet if applicable}\n+```\n+\n+## Why This Works\n+\n+{1-2 sentences explaining why this solution addresses the root cause}\n+\n+## Prevention\n+\n+- {How to avoid this in future}\n+- {Test or check that would catch this}\n+- {Documentation or comment that would help}\n+\n+## Related\n+\n+- {Link to related solution if any}\n+- {External documentation if relevant}\n+```\n+\n+### Step 5: Confirm\n+\n+After writing the file, confirm:\n+\n+```\n+Solution captured: docs/solutions/{category}/{slug}-{date}.md\n+\n+Tags: [{tags}]\n+\n+Future sessions can find this via:\n+  grep -riwl \"{keyword}\" docs/solutions/\n+```\n+\n+## Example Output\n+\n+```markdown\n+---\n+title: \"macOS ps returns different format than Linux\"\n+date: 2026-01-30\n+problem_type: runtime_error\n+component: \"config/hooks/_common.py\"\n+root_cause: platform_difference\n+resolution_type: deletion\n+severity: high\n+symptoms:\n+  - \"PID-scoped state files not found on macOS\"\n+  - \"Auto-approval hooks fail silently\"\n+  - \"Works on Linux, fails on macOS\"\n+tags: [hooks, macos, pid, basename, platform, state-files]\n+---\n+\n+# macOS ps returns different format than Linux\n+\n+## Problem\n+\n+PID-scoped state isolation silently failed on macOS because `_get_ancestor_pid()` used `basename` on paths that differ between platforms.\n+\n+## Symptoms\n+\n+- PID-scoped state files created but never found\n+- Auto-approval hooks didn't work on macOS\n+- Same code worked perfectly on Linux CI\n+\n+## What Didn't Work\n+\n+**Attempt 1:** Added fallback path for /proc/ not existing\n+- Why it failed: The `basename` call itself was the problem, not the path lookup\n+\n+**Attempt 2:** Used psutil for cross-platform process info\n+- Why it failed: Violated the \"no new dependencies\" constraint\n+\n+## Root Cause\n+\n+`ps -o comm=` returns different formats:\n+- Linux: `/usr/bin/python3` (full path)\n+- macOS: `python3` (name only)\n+\n+`basename()` on a name without path separators strips incorrectly.\n+\n+## Solution\n+\n+Deleted entire PID-scoping approach (473 lines). Replaced with session_id-based isolation via git worktrees.\n+\n+## Why This Works\n+\n+Session IDs are platform-independent strings. Git worktrees provide the isolation that PID-scoping was trying to achieve.\n+\n+## Pre\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/analysis-persistent-memory-for-harnesses.md",
    "docs/index.md",
    "docs/memory-integration-analysis.md",
    "docs/philosophy.md",
    "docs/audiobook-the-amnesiac-architect.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an repair/build session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nfeat(compound): add /compound skill for cross-session knowledge capture\n\nImplements Phase 1 and 1.5 of the Compound Memory System:\n\nPhase 1 - /compound skill:\n- config/skills/compound/SKILL.md: Structured knowledge capture workflow\n- config/skills/compound/references/solution-schema.md: Controlled vocabulary\n  (11 problem types, 16 root causes, 10 resolution types, 4 severity levels)\n- docs/solutions/: Knowledge base directory with category subdirectories\n\nPhase 1.5 - Retrieval integration:\n- config/skills/build/SKILL.md: Added past solutions search to Phase 0.5\n  planning (grep docs/solutions/ for task keywords)\n\nDesigned based on 7-agent /heavy analysis:\n- Filesystem agents outperform vector DBs (Letta 2026: 74% vs 68.5%)\n- Manual trigger for quality control\n- Local-first, no cloud dependencies\n- ~225 lines total\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/analysis-persistent-memory-for-harnesses.md\n- docs/index.md\n- docs/memory-integration-analysis.md\n- docs/philosophy.md\n- docs/audiobook-the-amnesiac-architect.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 36fa2eb4d308c2e46915072967bfa712e0d6474c\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Sat Jan 31 01:23:55 2026 +0100\n\n    feat(compound): add /compound skill for cross-session knowledge capture\n    \n    Implements Phase 1 and 1.5 of the Compound Memory System:\n    \n    Phase 1 - /compound skill:\n    - config/skills/compound/SKILL.md: Structured knowledge capture workflow\n    - config/skills/compound/references/solution-schema.md: Controlled vocabulary\n      (11 problem types, 16 root causes, 10 resolution types, 4 severity levels)\n    - docs/solutions/: Knowledge base directory with category subdirectories\n    \n    Phase 1.5 - Retrieval integration:\n    - config/skills/build/SKILL.md: Added past solutions search to Phase 0.5\n      planning (grep docs/solutions/ for task keywords)\n    \n    Designed based on 7-agent /heavy analysis:\n    - Filesystem agents outperform vector DBs (Letta 2026: 74% vs 68.5%)\n    - Manual trigger for quality control\n    - Local-first, no cloud dependencies\n    - ~225 lines total\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/skills/build/SKILL.md                       |   6 +\n config/skills/compound/SKILL.md                    | 240 +++++++++++++++++++++\n .../skills/compound/references/solution-schema.md  | 114 ++++++++++\n docs/index.md                                      |   4 +-\n docs/solutions/.gitkeep                            |  44 ++++\n 5 files changed, 407 insertions(+), 1 deletion(-)\n\ndiff --git a/config/skills/build/SKILL.md b/config/skills/build/SKILL.md\nindex c87f48c..8d01f72 100644\n--- a/config/skills/build/SKILL.md\n+++ b/config/skills/build/SKILL.md\n@@ -320,6 +320,12 @@ Lite Heavy is a streamlined version of `/heavy` that provides multi-perspective\n    - Environment and deployment configs\n    - Relevant code patterns for the task\n    - Existing tests and validation\n+   - **Past solutions** (if `docs/solutions/` exists):\n+     ```bash\n+     grep -riwl \"{task-keyword}\" docs/solutions/\n+     ```\n+     Read any matching files \u2014 they contain root causes, failed attempts,\n+     and prevention guidance from previous sessions.\n \n 3. **Read `/heavy` agent prompts and generate dynamic perspectives**:\n \ndiff --git a/config/skills/compound/SKILL.md b/config/skills/compound/SKILL.md\nnew file mode 100644\nindex 0000000..2383154\n--- /dev/null\n+++ b/config/skills/compound/SKILL.md\n@@ -0,0 +1,240 @@\n+---\n+name: compound\n+description: Capture solved problems as structured markdown for cross-session learning. Use when you've solved a non-trivial problem and want future sessions to benefit. Triggers on \"/compound\", \"document this solution\", \"capture this learning\".\n+---\n+\n+# Knowledge Capture (/compound)\n+\n+Capture solved problems as structured markdown with YAML frontmatter. Creates searchable solution documents that future sessions can reference during planning.\n+\n+## When to Use\n+\n+- After debugging a non-trivial issue\n+- After discovering a platform-specific gotcha\n+- After finding a root cause that wasn't obvious\n+- After trying multiple approaches and finding one that works\n+- After making an architectural decision with rationale\n+\n+**Quality gate**: This is manual trigger by design. Not every fix deserves permanent documentation. Use `/compound` when the learning would save time in future sessions.\n+\n+## Triggers\n+\n+- `/compound`\n+- \"document this solution\"\n+- \"capture this learning\"\n+- \"remember this fix\"\n+\n+## Workflow\n+\n+### Step 1: Extract Context from Current Session\n+\n+Review the current session to identify:\n+\n+1. **Problem**: What was broken or unclear?\n+2. **Symptoms**: What did the user or system observe?\n+3. **Investigation**: What did you try?\n+4. **What Didn't Work**: Failed approaches and why\n+5. **Root Cause**: The actual underlying issue\n+6. **Solution**: What fixed it\n+7. **Prevention**: How to avoid this in future\n+\n+### Step 2: Classify with Schema\n+\n+Read `~/.claude/skills/compound/references/solution-schema.md` for the controlled vocabulary.\n+\n+Select:\n+- **problem_type**: One of 11 types (maps to category directory)\n+- **root_cause**: One of 16 causes\n+- **resolution_type**: One of 10 types\n+- **severity**: critical, high, medium, low\n+- **tags**: 3-7 searchable keywords\n+\n+### Step 3: Generate File Path\n+\n+```\n+docs/solutions/{category}/{slug}-{YYYYMMDD}.md\n+```\n+\n+| problem_type | category directory |\n+|--------------|-------------------|\n+| build_error | build-errors |\n+| test_failure | test-failures |\n+| runtime_error | runtime-errors |\n+| performance_issue | performance |\n+| config_error | config-errors |\n+| dependency_issue | dependencies |\n+| integration_issue | integrations |\n+| logic_error | logic-errors |\n+| design_flaw | design-flaws |\n+| infrastructure_issue | infrastructure |\n+| security_issue | security |\n+\n+**Slug format**: lowercase-hyphenated summary of the problem (max 50 chars)\n+\n+### Step 4: Write Solution Document\n+\n+```markdown\n+---\n+title: \"{Concise problem description}\"\n+date: {YYYY-MM-DD}\n+problem_type: {from schema}\n+component: \"{file or module affected}\"\n+root_cause: {from schema}\n+resolution_type: {from schema}\n+severity: {critical|high|medium|low}\n+symptoms:\n+  - \"{Observable symptom 1}\"\n+  - \"{Observable symptom 2}\"\n+tags: [{keyword1}, {keyword2}, {keyword3}]\n+---\n+\n+# {Title}\n+\n+## Problem\n+\n+{1-3 sentences describing what was broken or unclear}\n+\n+## Symptoms\n+\n+- {What the user or system observed}\n+- {Error messages if any}\n+- {Unexpected behavior}\n+\n+## What Didn't Work\n+\n+**Attempt 1:** {What you tried}\n+- Why it failed: {Explanation}\n+\n+**Attempt 2:** {What you tried}\n+- Why it failed: {Explanation}\n+\n+## Root Cause\n+\n+{2-5 sentences explaining the actual underlying issue}\n+\n+## Solution\n+\n+{Description of what fixed it}\n+\n+```{language}\n+{Code snippet if applicable}\n+```\n+\n+## Why This Works\n+\n+{1-2 sentences explaining why this solution addresses the root cause}\n+\n+## Prevention\n+\n+- {How to avoid this in future}\n+- {Test or check that would catch this}\n+- {Documentation or comment that would help}\n+\n+## Related\n+\n+- {Link to related solution if any}\n+- {External documentation if relevant}\n+```\n+\n+### Step 5: Confirm\n+\n+After writing the file, confirm:\n+\n+```\n+Solution captured: docs/solutions/{category}/{slug}-{date}.md\n+\n+Tags: [{tags}]\n+\n+Future sessions can find this via:\n+  grep -riwl \"{keyword}\" docs/solutions/\n+```\n+\n+## Example Output\n+\n+```markdown\n+---\n+title: \"macOS ps returns different format than Linux\"\n+date: 2026-01-30\n+problem_type: runtime_error\n+component: \"config/hooks/_common.py\"\n+root_cause: platform_difference\n+resolution_type: deletion\n+severity: high\n+symptoms:\n+  - \"PID-scoped state files not found on macOS\"\n+  - \"Auto-approval hooks fail silently\"\n+  - \"Works on Linux, fails on macOS\"\n+tags: [hooks, macos, pid, basename, platform, state-files]\n+---\n+\n+# macOS ps returns different format than Linux\n+\n+## Problem\n+\n+PID-scoped state isolation silently failed on macOS because `_get_ancestor_pid()` used `basename` on paths that differ between platforms.\n+\n+## Symptoms\n+\n+- PID-scoped state files created but never found\n+- Auto-approval hooks didn't work on macOS\n+- Same code worked perfectly on Linux CI\n+\n+## What Didn't Work\n+\n+**Attempt 1:** Added fallback path for /proc/ not existing\n+- Why it failed: The `basename` call itself was the problem, not the path lookup\n+\n+**Attempt 2:** Used psutil for cross-platform process info\n+- Why it failed: Violated the \"no new dependencies\" constraint\n+\n+## Root Cause\n+\n+`ps -o comm=` returns different formats:\n+- Linux: `/usr/bin/python3` (full path)\n+- macOS: `python3` (name only)\n+\n+`basename()` on a name without path separators strips incorrectly.\n+\n+## Solution\n+\n+Deleted entire PID-scoping approach (473 lines). Replaced with session_id-based isolation via git worktrees.\n+\n+## Why This Works\n+\n+Session IDs are platform-independent strings. Git worktrees provide the isolation that PID-scoping was trying to achieve.\n+\n+## Pre\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}