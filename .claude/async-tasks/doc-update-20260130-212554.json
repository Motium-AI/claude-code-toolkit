{
  "type": "doc-update",
  "created_at": "2026-01-30T21:25:54.810363+00:00",
  "status": "pending",
  "commit_message": "feat(episode): add /episode skill for AI video generation\n\nImplements educational video episode generation with Minecraft-style graphics:\n- SKILL.md: 7-act episode structure, Minecraft visual style guide, manifest schema\n- pipeline.py: fal.ai Kling/Flux + ElevenLabs TTS + FFmpeg assembly orchestrator\n- Hook integration: is_episode_active(), state file management, triggers\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 31fe31fb25b437614bd200da488fbad41687be5b\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 22:25:54 2026 +0100\n\n    feat(episode): add /episode skill for AI video generation\n    \n    Implements educational video episode generation with Minecraft-style graphics:\n    - SKILL.md: 7-act episode structure, Minecraft visual style guide, manifest schema\n    - pipeline.py: fal.ai Kling/Flux + ElevenLabs TTS + FFmpeg assembly orchestrator\n    - Hook integration: is_episode_active(), state file management, triggers\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/commands/episode.md                     |  35 ++\n config/hooks/_state.py                         |  41 +-\n config/hooks/skill-continuation-reminder.py    |   5 +-\n config/hooks/skill-state-initializer.py        |   9 +-\n config/skills/episode/SKILL.md                 | 336 ++++++++++++++\n config/skills/episode/scripts/pipeline.py      | 609 +++++++++++++++++++++++++\n config/skills/episode/scripts/requirements.txt |   2 +\n 7 files changed, 1030 insertions(+), 7 deletions(-)\n\ndiff --git a/config/commands/episode.md b/config/commands/episode.md\nnew file mode 100644\nindex 0000000..3990f20\n--- /dev/null\n+++ b/config/commands/episode.md\n@@ -0,0 +1,35 @@\n+---\n+description: Generate educational video episodes with Minecraft-style graphics\n+argument-hint: <topic> [--duration 3|10]\n+---\n+\n+# /episode\n+\n+Generate educational video episodes with Minecraft-style graphics.\n+\n+## Arguments\n+\n+- `<topic>` - The educational topic to explain (required)\n+- `--duration 3|10` - Episode duration in minutes (default: 3)\n+\n+## Examples\n+\n+```\n+/episode \"How photosynthesis works\"\n+/episode \"Introduction to fractions\" --duration 10\n+/episode \"The water cycle\"\n+```\n+\n+## Instructions\n+\n+1. **Read the episode skill** to understand the workflow:\n+   @~/.claude/skills/episode/SKILL.md\n+\n+2. **Write the episode script** as a JSON manifest following the 7-act structure\n+\n+3. **Run the pipeline** to generate media:\n+   ```bash\n+   python3 ~/.claude/skills/episode/scripts/pipeline.py episodes/EP001/manifest.json\n+   ```\n+\n+4. **Review the output** at `episodes/EP001/episode.mp4`\ndiff --git a/config/hooks/_state.py b/config/hooks/_state.py\nindex 091d42a..4460a08 100644\n--- a/config/hooks/_state.py\n+++ b/config/hooks/_state.py\n@@ -229,12 +229,38 @@ def is_burndown_active(cwd: str, session_id: str = \"\") -> bool:\n     return False\n \n \n+def is_episode_active(cwd: str, session_id: str = \"\") -> bool:\n+    \"\"\"Check if episode generation mode is active via state file or env var.\"\"\"\n+    state = load_state_file(cwd, \"episode-state.json\")\n+    if state and not is_state_expired(state):\n+        return True\n+\n+    user_state_path = Path.home() / \".claude\" / \"episode-state.json\"\n+    if user_state_path.exists():\n+        try:\n+            user_state = json.loads(user_state_path.read_text())\n+            if not is_state_expired(user_state) and _is_cwd_under_origin(cwd, user_state, session_id):\n+                return True\n+        except (json.JSONDecodeError, IOError):\n+            pass\n+\n+    if os.environ.get(\"EPISODE_ACTIVE\", \"\").lower() in (\"true\", \"1\", \"yes\"):\n+        return True\n+\n+    return False\n+\n+\n def is_autonomous_mode_active(cwd: str, session_id: str = \"\") -> bool:\n-    \"\"\"Check if any autonomous execution mode is active (build, repair, or burndown).\n+    \"\"\"Check if any autonomous execution mode is active (build, repair, burndown, or episode).\n \n     This is the unified check for enabling auto-approval hooks.\n     \"\"\"\n-    return is_build_active(cwd, session_id) or is_repair_active(cwd, session_id) or is_burndown_active(cwd, session_id)\n+    return (\n+        is_build_active(cwd, session_id)\n+        or is_repair_active(cwd, session_id)\n+        or is_burndown_active(cwd, session_id)\n+        or is_episode_active(cwd, session_id)\n+    )\n \n \n def get_autonomous_state(cwd: str, session_id: str = \"\") -> tuple[dict | None, str | None]:\n@@ -260,11 +286,16 @@ def get_autonomous_state(cwd: str, session_id: str = \"\") -> tuple[dict | None, s\n     if burndown_state and not is_state_expired(burndown_state):\n         return burndown_state, \"burndown\"\n \n+    episode_state = load_state_file(cwd, \"episode-state.json\")\n+    if episode_state and not is_state_expired(episode_state):\n+        return episode_state, \"episode\"\n+\n     for filename, state_type in [\n         (\"build-state.json\", \"build\"),\n         (\"forge-state.json\", \"build\"),\n         (\"appfix-state.json\", \"repair\"),\n         (\"burndown-state.json\", \"burndown\"),\n+        (\"episode-state.json\", \"episode\"),\n     ]:\n         user_path = Path.home() / \".claude\" / filename\n         if user_path.exists():\n@@ -291,7 +322,7 @@ def cleanup_autonomous_state(cwd: str) -> list[str]:\n     2. ALL .claude/ directories walking UP from cwd\n     \"\"\"\n     deleted = []\n-    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\"]\n+    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\", \"episode-state.json\"]\n \n     # 1. Clean user-level state\n     user_claude_dir = Path.home() / \".claude\"\n@@ -381,7 +412,7 @@ def cleanup_expired_state(cwd: str, current_session_id: str = \"\") -> list[str]:\n     Called at SessionStart to clean up stale state from previous sessions.\n     \"\"\"\n     deleted = []\n-    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\"]\n+    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\", \"episode-state.json\"]\n \n     def _should_clean(state_path: Path) -> bool:\n         try:\n@@ -458,7 +489,7 @@ def reset_state_for_next_task(cwd: str) -> bool:\n     Increments iteration, resets plan_mode_completed, updates last_activity_at,\n     clears per-task fields. Does NOT delete the state file (sticky session behavior).\n     \"\"\"\n-    for filename in (\"build-state.json\", \"forge-state.json\", \"appfix-state.json\", \"burndown-state.json\"):\n+    for filename in (\"build-state.json\", \"forge-state.json\", \"appfix-state.json\", \"burndown-state.json\", \"episode-state.json\"):\n         state_path = _find_state_file_path(cwd, filename)\n         if state_path:\n             try:\ndiff --git a/config/hooks/skill-continuation-reminder.py b/config/hooks/skill-continuation-reminder.py\nindex 03014cc..7e34e6b 100644\n--- a/config/hooks/skill-continuation-reminder.py\n+++ b/config/hooks/skill-continuation-reminder.py\n@@ -18,7 +18,7 @@ from pathlib import Path\n \n # Add hooks directory to path for shared imports\n sys.path.insert(0, str(Path(__file__).parent))\n-from _state import is_autonomous_mode_active, is_appfix_active, is_build_active\n+from _state import is_autonomous_mode_active, is_appfix_active, is_build_active, is_episode_active\n \n \n def main():\n@@ -44,6 +44,9 @@ def main():\n     elif is_build_active(cwd):\n         mode_name = \"BUILD\"\n         loop_type = \"task execution\"\n+    elif is_episode_active(cwd):\n+        mode_name = \"EPISODE\"\n+        loop_type = \"episode generation\"\n     else:\n         sys.exit(0)\n \ndiff --git a/config/hooks/skill-state-initializer.py b/config/hooks/skill-state-initializer.py\nindex 8ba92fd..6e5c4ad 100755\n--- a/config/hooks/skill-state-initializer.py\n+++ b/config/hooks/skill-state-initializer.py\n@@ -44,13 +44,14 @@ DEACTIVATION_PATTERNS = [\n     r\"(?:^|\\s)/repair\\s+off\\b\",  # Primary debugging skill\n     r\"(?:^|\\s)/build\\s+off\\b\",  # Primary task execution skill\n     r\"(?:^|\\s)/burndown\\s+off\\b\",  # Tech debt elimination skill\n+    r\"(?:^|\\s)/episode\\s+off\\b\",  # Video episode generation skill\n     r\"(?:^|\\s)/appfix\\s+off\\b\",  # Internal web debugging\n     r\"(?:^|\\s)/mobileappfix\\s+off\\b\",  # Internal mobile debugging\n     r\"(?:^|\\s)/forge\\s+off\\b\",  # Legacy alias\n     r\"(?:^|\\s)/godo\\s+off\\b\",  # Legacy alias\n     r\"\\bstop autonomous mode\\b\",\n     r\"\\bdisable auto[- ]?approval\\b\",\n-    r\"\\bturn off (repair|build|forge|burndown|appfix|mobileappfix\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/analysis-persistent-memory-for-harnesses.md",
    "docs/index.md",
    "docs/memory-integration-analysis.md",
    "docs/philosophy.md",
    "docs/audiobook-the-amnesiac-architect.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an repair/build session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nfeat(episode): add /episode skill for AI video generation\n\nImplements educational video episode generation with Minecraft-style graphics:\n- SKILL.md: 7-act episode structure, Minecraft visual style guide, manifest schema\n- pipeline.py: fal.ai Kling/Flux + ElevenLabs TTS + FFmpeg assembly orchestrator\n- Hook integration: is_episode_active(), state file management, triggers\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/analysis-persistent-memory-for-harnesses.md\n- docs/index.md\n- docs/memory-integration-analysis.md\n- docs/philosophy.md\n- docs/audiobook-the-amnesiac-architect.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 31fe31fb25b437614bd200da488fbad41687be5b\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 22:25:54 2026 +0100\n\n    feat(episode): add /episode skill for AI video generation\n    \n    Implements educational video episode generation with Minecraft-style graphics:\n    - SKILL.md: 7-act episode structure, Minecraft visual style guide, manifest schema\n    - pipeline.py: fal.ai Kling/Flux + ElevenLabs TTS + FFmpeg assembly orchestrator\n    - Hook integration: is_episode_active(), state file management, triggers\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/commands/episode.md                     |  35 ++\n config/hooks/_state.py                         |  41 +-\n config/hooks/skill-continuation-reminder.py    |   5 +-\n config/hooks/skill-state-initializer.py        |   9 +-\n config/skills/episode/SKILL.md                 | 336 ++++++++++++++\n config/skills/episode/scripts/pipeline.py      | 609 +++++++++++++++++++++++++\n config/skills/episode/scripts/requirements.txt |   2 +\n 7 files changed, 1030 insertions(+), 7 deletions(-)\n\ndiff --git a/config/commands/episode.md b/config/commands/episode.md\nnew file mode 100644\nindex 0000000..3990f20\n--- /dev/null\n+++ b/config/commands/episode.md\n@@ -0,0 +1,35 @@\n+---\n+description: Generate educational video episodes with Minecraft-style graphics\n+argument-hint: <topic> [--duration 3|10]\n+---\n+\n+# /episode\n+\n+Generate educational video episodes with Minecraft-style graphics.\n+\n+## Arguments\n+\n+- `<topic>` - The educational topic to explain (required)\n+- `--duration 3|10` - Episode duration in minutes (default: 3)\n+\n+## Examples\n+\n+```\n+/episode \"How photosynthesis works\"\n+/episode \"Introduction to fractions\" --duration 10\n+/episode \"The water cycle\"\n+```\n+\n+## Instructions\n+\n+1. **Read the episode skill** to understand the workflow:\n+   @~/.claude/skills/episode/SKILL.md\n+\n+2. **Write the episode script** as a JSON manifest following the 7-act structure\n+\n+3. **Run the pipeline** to generate media:\n+   ```bash\n+   python3 ~/.claude/skills/episode/scripts/pipeline.py episodes/EP001/manifest.json\n+   ```\n+\n+4. **Review the output** at `episodes/EP001/episode.mp4`\ndiff --git a/config/hooks/_state.py b/config/hooks/_state.py\nindex 091d42a..4460a08 100644\n--- a/config/hooks/_state.py\n+++ b/config/hooks/_state.py\n@@ -229,12 +229,38 @@ def is_burndown_active(cwd: str, session_id: str = \"\") -> bool:\n     return False\n \n \n+def is_episode_active(cwd: str, session_id: str = \"\") -> bool:\n+    \"\"\"Check if episode generation mode is active via state file or env var.\"\"\"\n+    state = load_state_file(cwd, \"episode-state.json\")\n+    if state and not is_state_expired(state):\n+        return True\n+\n+    user_state_path = Path.home() / \".claude\" / \"episode-state.json\"\n+    if user_state_path.exists():\n+        try:\n+            user_state = json.loads(user_state_path.read_text())\n+            if not is_state_expired(user_state) and _is_cwd_under_origin(cwd, user_state, session_id):\n+                return True\n+        except (json.JSONDecodeError, IOError):\n+            pass\n+\n+    if os.environ.get(\"EPISODE_ACTIVE\", \"\").lower() in (\"true\", \"1\", \"yes\"):\n+        return True\n+\n+    return False\n+\n+\n def is_autonomous_mode_active(cwd: str, session_id: str = \"\") -> bool:\n-    \"\"\"Check if any autonomous execution mode is active (build, repair, or burndown).\n+    \"\"\"Check if any autonomous execution mode is active (build, repair, burndown, or episode).\n \n     This is the unified check for enabling auto-approval hooks.\n     \"\"\"\n-    return is_build_active(cwd, session_id) or is_repair_active(cwd, session_id) or is_burndown_active(cwd, session_id)\n+    return (\n+        is_build_active(cwd, session_id)\n+        or is_repair_active(cwd, session_id)\n+        or is_burndown_active(cwd, session_id)\n+        or is_episode_active(cwd, session_id)\n+    )\n \n \n def get_autonomous_state(cwd: str, session_id: str = \"\") -> tuple[dict | None, str | None]:\n@@ -260,11 +286,16 @@ def get_autonomous_state(cwd: str, session_id: str = \"\") -> tuple[dict | None, s\n     if burndown_state and not is_state_expired(burndown_state):\n         return burndown_state, \"burndown\"\n \n+    episode_state = load_state_file(cwd, \"episode-state.json\")\n+    if episode_state and not is_state_expired(episode_state):\n+        return episode_state, \"episode\"\n+\n     for filename, state_type in [\n         (\"build-state.json\", \"build\"),\n         (\"forge-state.json\", \"build\"),\n         (\"appfix-state.json\", \"repair\"),\n         (\"burndown-state.json\", \"burndown\"),\n+        (\"episode-state.json\", \"episode\"),\n     ]:\n         user_path = Path.home() / \".claude\" / filename\n         if user_path.exists():\n@@ -291,7 +322,7 @@ def cleanup_autonomous_state(cwd: str) -> list[str]:\n     2. ALL .claude/ directories walking UP from cwd\n     \"\"\"\n     deleted = []\n-    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\"]\n+    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\", \"episode-state.json\"]\n \n     # 1. Clean user-level state\n     user_claude_dir = Path.home() / \".claude\"\n@@ -381,7 +412,7 @@ def cleanup_expired_state(cwd: str, current_session_id: str = \"\") -> list[str]:\n     Called at SessionStart to clean up stale state from previous sessions.\n     \"\"\"\n     deleted = []\n-    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\"]\n+    state_files = [\"appfix-state.json\", \"build-state.json\", \"forge-state.json\", \"burndown-state.json\", \"episode-state.json\"]\n \n     def _should_clean(state_path: Path) -> bool:\n         try:\n@@ -458,7 +489,7 @@ def reset_state_for_next_task(cwd: str) -> bool:\n     Increments iteration, resets plan_mode_completed, updates last_activity_at,\n     clears per-task fields. Does NOT delete the state file (sticky session behavior).\n     \"\"\"\n-    for filename in (\"build-state.json\", \"forge-state.json\", \"appfix-state.json\", \"burndown-state.json\"):\n+    for filename in (\"build-state.json\", \"forge-state.json\", \"appfix-state.json\", \"burndown-state.json\", \"episode-state.json\"):\n         state_path = _find_state_file_path(cwd, filename)\n         if state_path:\n             try:\ndiff --git a/config/hooks/skill-continuation-reminder.py b/config/hooks/skill-continuation-reminder.py\nindex 03014cc..7e34e6b 100644\n--- a/config/hooks/skill-continuation-reminder.py\n+++ b/config/hooks/skill-continuation-reminder.py\n@@ -18,7 +18,7 @@ from pathlib import Path\n \n # Add hooks directory to path for shared imports\n sys.path.insert(0, str(Path(__file__).parent))\n-from _state import is_autonomous_mode_active, is_appfix_active, is_build_active\n+from _state import is_autonomous_mode_active, is_appfix_active, is_build_active, is_episode_active\n \n \n def main():\n@@ -44,6 +44,9 @@ def main():\n     elif is_build_active(cwd):\n         mode_name = \"BUILD\"\n         loop_type = \"task execution\"\n+    elif is_episode_active(cwd):\n+        mode_name = \"EPISODE\"\n+        loop_type = \"episode generation\"\n     else:\n         sys.exit(0)\n \ndiff --git a/config/hooks/skill-state-initializer.py b/config/hooks/skill-state-initializer.py\nindex 8ba92fd..6e5c4ad 100755\n--- a/config/hooks/skill-state-initializer.py\n+++ b/config/hooks/skill-state-initializer.py\n@@ -44,13 +44,14 @@ DEACTIVATION_PATTERNS = [\n     r\"(?:^|\\s)/repair\\s+off\\b\",  # Primary debugging skill\n     r\"(?:^|\\s)/build\\s+off\\b\",  # Primary task execution skill\n     r\"(?:^|\\s)/burndown\\s+off\\b\",  # Tech debt elimination skill\n+    r\"(?:^|\\s)/episode\\s+off\\b\",  # Video episode generation skill\n     r\"(?:^|\\s)/appfix\\s+off\\b\",  # Internal web debugging\n     r\"(?:^|\\s)/mobileappfix\\s+off\\b\",  # Internal mobile debugging\n     r\"(?:^|\\s)/forge\\s+off\\b\",  # Legacy alias\n     r\"(?:^|\\s)/godo\\s+off\\b\",  # Legacy alias\n     r\"\\bstop autonomous mode\\b\",\n     r\"\\bdisable auto[- ]?approval\\b\",\n-    r\"\\bturn off (repair|build|forge|burndown|appfix|mobileappfix\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}