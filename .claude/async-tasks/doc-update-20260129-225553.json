{
  "type": "doc-update",
  "created_at": "2026-01-29T22:55:53.539058+00:00",
  "status": "pending",
  "commit_message": "refactor(hooks): consolidate auto-approval and add references\n\nMajor changes:\n- Remove deprecated hooks (appfix-auto-approve, appfix-bash-auto-approve,\n  appfix-exitplan-auto-approve, checkpoint-write-validator, skill-reminder,\n  skilltest-runner)\n- Add exa-search-enforcer.py to prefer Exa MCP over WebSearch\n- Add gateway-emit.py for external integrations\n- Add reference docs for appfix/mobileappfix (checkpoint-schema,\n  troubleshooting, worktree-guide, etc.)\n- Simplify SKILL.md files with references for detailed content\n- Add new skills: revonc-eas-deploy, skill-sandbox, skill-tester, skilltest\n- Update tests for new hook patterns\n- Add skills.md documentation\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 76c01ffb8c323ec6daeed4443c4eef0cf053f2b2\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Thu Jan 29 23:55:53 2026 +0100\n\n    refactor(hooks): consolidate auto-approval and add references\n    \n    Major changes:\n    - Remove deprecated hooks (appfix-auto-approve, appfix-bash-auto-approve,\n      appfix-exitplan-auto-approve, checkpoint-write-validator, skill-reminder,\n      skilltest-runner)\n    - Add exa-search-enforcer.py to prefer Exa MCP over WebSearch\n    - Add gateway-emit.py for external integrations\n    - Add reference docs for appfix/mobileappfix (checkpoint-schema,\n      troubleshooting, worktree-guide, etc.)\n    - Simplify SKILL.md files with references for detailed content\n    - Add new skills: revonc-eas-deploy, skill-sandbox, skill-tester, skilltest\n    - Update tests for new hook patterns\n    - Add skills.md documentation\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n README.md                                          |    8 +-\n config/hooks/_common.py                            |   92 ++\n config/hooks/_sv_templates.py                      |  148 +--\n config/hooks/_sv_validators.py                     |  170 +--\n config/hooks/appfix-auto-approve.py                |  106 --\n config/hooks/appfix-bash-auto-approve.py           |   63 -\n config/hooks/appfix-exitplan-auto-approve.py       |   71 -\n config/hooks/bash-version-tracker.py               |  272 +---\n config/hooks/checkpoint-invalidator.py             |  330 +----\n config/hooks/checkpoint-write-validator.py         |  242 ----\n config/hooks/exa-search-enforcer.py                |   63 +\n config/hooks/gateway-emit.py                       |  164 +++\n config/hooks/plan-execution-reminder.py            |  153 +--\n config/hooks/skill-reminder.py                     |  142 --\n config/hooks/skilltest-runner.py                   |  881 -------------\n config/hooks/tests/test_plan_mode_hooks.py         |   23 +-\n config/hooks/tests/test_sticky_session.py          |   45 +-\n config/hooks/tests/test_sv_validators.py           |   91 +-\n config/skills/appfix/SKILL.md                      | 1367 ++------------------\n .../skills/appfix/references/checkpoint-schema.md  |   76 ++\n .../appfix/references/infrastructure-sync.md       |   28 +\n .../skills/appfix/references/surf-verification.md  |   57 +\n config/skills/appfix/references/troubleshooting.md |   57 +\n config/skills/appfix/references/worktree-guide.md  |   70 +\n config/skills/heavy/SKILL.md                       |   25 +-\n config/skills/mobileappfix/SKILL.md                |  127 +-\n .../mobileappfix/references/debugging-rubric.md    |  372 ++++++\n .../references/maestro-mcp-contract.md             |  239 ++++\n .../references/maestro-smoke-contract.md           |  254 ++++\n .../mobileappfix/references/mobile-topology.md     |  299 +++++\n .../references/validation-tests-contract.md        |  251 ++++\n config/skills/revonc-eas-deploy/SKILL.md           |  329 +++++\n config/skills/skill-sandbox/SKILL.md               |  697 ++++++++++\n .../skills/skill-sandbox/scripts/sandbox-setup.sh  |  473 +++++++\n config/skills/skill-tester/SKILL.md                |   45 +\n config/skills/skill-tester/scripts/test-skill.sh   |  227 ++++\n config/skills/skilltest/SKILL.md                   |   46 +\n config/skills/toolkit/SKILL.md                     |   55 +-\n .../toolkit/references/claude-md-optimizer.md      |  321 +++++\n docs/concepts/skills.md                            |  130 ++\n docs/research/agentic-ai-2026-research-report.md   | 1206 +++++++++++++++++\n scripts/skill-tester.sh                            |  452 +++++++\n scripts/test-sticky-session-e2e.sh                 |  494 +++++++\n 43 files changed, 6852 insertions(+), 3909 deletions(-)\n\ndiff --git a/README.md b/README.md\nindex 7b74e46..49f9f8e 100644\n--- a/README.md\n+++ b/README.md\n@@ -97,7 +97,7 @@ Claude cannot stop until the job is actually done. A completion checkpoint enfor\n \n If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n \n-### Hook System (15 registered)\n+### Hook System (19 registered)\n \n | Hook | Event | Purpose |\n |------|-------|---------|\n@@ -106,11 +106,15 @@ If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n | `read-docs-reminder.py` | SessionStart | Forces reading docs on start |\n | `skill-state-initializer.py` | UserPromptSubmit | Creates state files on `/godo` or `/appfix` |\n | `read-docs-trigger.py` | UserPromptSubmit | Suggests reading relevant docs |\n+| `pretooluse-auto-approve.py` | PreToolUse (*) | Auto-approves during autonomous mode |\n | `plan-mode-enforcer.py` | PreToolUse (Edit/Write) | Blocks Edit/Write until plan mode completes |\n | `deploy-enforcer.py` | PreToolUse (Bash) | Blocks subagent/production deploys |\n+| `azure-command-guard.sh` | PreToolUse (Bash) | Guards Azure CLI commands |\n+| `exa-search-enforcer.py` | PreToolUse (WebSearch) | Reminds to use Exa MCP instead |\n | `checkpoint-invalidator.py` | PostToolUse (Edit/Write) | Resets checkpoint when code changes |\n | `checkpoint-write-validator.py` | PostToolUse (Write) | Warns on claims without evidence |\n | `bash-version-tracker.py` | PostToolUse (Bash) | Tracks version changes after commits |\n+| `doc-updater-async.py` | PostToolUse (Bash) | Suggests doc updates after commits |\n | `plan-mode-tracker.py` | PostToolUse (ExitPlanMode) | Marks plan mode completed |\n | `plan-execution-reminder.py` | PostToolUse (ExitPlanMode) | Injects autonomous execution context |\n | `skill-continuation-reminder.py` | PostToolUse (Skill) | Continues loop after skill delegation |\n@@ -158,6 +162,7 @@ If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n | `design-improver` | UI review, design audit |\n | `ux-improver` | UX review, usability audit |\n | `docs-navigator` | Documentation, \"read the docs\" |\n+| `revonc-eas-deploy` | /eas, \"deploy to testflight\", \"build ios/android\" |\n \n ---\n \n@@ -186,6 +191,7 @@ claude-code-toolkit/\n | [QUICKSTART.md](QUICKSTART.md) | Installation guide |\n | [docs/index.md](docs/index.md) | Full reference |\n | [docs/skills/appfix-guide.md](docs/skills/appfix-guide.md) | Complete appfix guide |\n+| [docs/skills/godo-guide.md](docs/skills/godo-guide.md) | Autonomous task execution guide |\n | [docs/concepts/hooks.md](docs/concepts/hooks.md) | Hook system deep dive |\n \n ---\ndiff --git a/config/hooks/_common.py b/config/hooks/_common.py\nindex 1811083..93651d5 100755\n--- a/config/hooks/_common.py\n+++ b/config/hooks/_common.py\n@@ -875,7 +875,99 @@ def save_checkpoint(cwd: str, checkpoint: dict) -> bool:\n         return False\n     checkpoint_path = Path(cwd) / \".claude\" / \"completion-checkpoint.json\"\n     try:\n+        checkpoint_path.parent.mkdir(parents=True, exist_ok=True)\n         checkpoint_path.write_text(json.dumps(checkpoint, indent=2))\n         return True\n     except IOError:\n         return False\n+\n+\n+# ============================================================================\n+# Checkpoint Invalidation (shared by checkpoint-invalidator, bash-version-tracker, stop-validator)\n+# ============================================================================\n+\n+# Code file extensions that trigger checkpoint invalidation\n+CODE_EXTENSIONS = {\n+    \".py\", \".ts\", \".tsx\", \".js\", \".jsx\", \".go\", \".rs\", \".java\", \".rb\", \".php\",\n+    \".vue\", \".svelte\",\n+    \".tf\", \".tfvars\", \".bicep\",\n+    \".yaml\", \".yml\",\n+    \".sql\", \".sh\", \".bash\",\n+}\n+\n+# Fields invalidated when code changes (in dependency order)\n+# When a field is invalidated, all fields that depend on it are also invalidated\n+FIELD_DEPENDENCIES = {\n+    \"linters_pass\": [],\n+    \"deployed\": [\"linters_pass\"],\n+    \"web_testing_done\": [\"deployed\"],\n+}\n+\n+# All version-dependent fields\n+VERSION_DEPENDENT_FIELDS = list(FIELD_DEPENDENCIES.keys())\n+\n+\n+def is_code_file(file_path: str) -> bool:\n+    \"\"\"Check if file is a code file based on extension.\"\"\"\n+    return Path(file_path).suffix.lower() in CODE_EXTENSIONS\n+\n+\n\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/index.md",
    "docs/philosophy.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an appfix/godo session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nrefactor(hooks): consolidate auto-approval and add references\n\nMajor changes:\n- Remove deprecated hooks (appfix-auto-approve, appfix-bash-auto-approve,\n  appfix-exitplan-auto-approve, checkpoint-write-validator, skill-reminder,\n  skilltest-runner)\n- Add exa-search-enforcer.py to prefer Exa MCP over WebSearch\n- Add gateway-emit.py for external integrations\n- Add reference docs for appfix/mobileappfix (checkpoint-schema,\n  troubleshooting, worktree-guide, etc.)\n- Simplify SKILL.md files with references for detailed content\n- Add new skills: revonc-eas-deploy, skill-sandbox, skill-tester, skilltest\n- Update tests for new hook patterns\n- Add skills.md documentation\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/index.md\n- docs/philosophy.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 76c01ffb8c323ec6daeed4443c4eef0cf053f2b2\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Thu Jan 29 23:55:53 2026 +0100\n\n    refactor(hooks): consolidate auto-approval and add references\n    \n    Major changes:\n    - Remove deprecated hooks (appfix-auto-approve, appfix-bash-auto-approve,\n      appfix-exitplan-auto-approve, checkpoint-write-validator, skill-reminder,\n      skilltest-runner)\n    - Add exa-search-enforcer.py to prefer Exa MCP over WebSearch\n    - Add gateway-emit.py for external integrations\n    - Add reference docs for appfix/mobileappfix (checkpoint-schema,\n      troubleshooting, worktree-guide, etc.)\n    - Simplify SKILL.md files with references for detailed content\n    - Add new skills: revonc-eas-deploy, skill-sandbox, skill-tester, skilltest\n    - Update tests for new hook patterns\n    - Add skills.md documentation\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n README.md                                          |    8 +-\n config/hooks/_common.py                            |   92 ++\n config/hooks/_sv_templates.py                      |  148 +--\n config/hooks/_sv_validators.py                     |  170 +--\n config/hooks/appfix-auto-approve.py                |  106 --\n config/hooks/appfix-bash-auto-approve.py           |   63 -\n config/hooks/appfix-exitplan-auto-approve.py       |   71 -\n config/hooks/bash-version-tracker.py               |  272 +---\n config/hooks/checkpoint-invalidator.py             |  330 +----\n config/hooks/checkpoint-write-validator.py         |  242 ----\n config/hooks/exa-search-enforcer.py                |   63 +\n config/hooks/gateway-emit.py                       |  164 +++\n config/hooks/plan-execution-reminder.py            |  153 +--\n config/hooks/skill-reminder.py                     |  142 --\n config/hooks/skilltest-runner.py                   |  881 -------------\n config/hooks/tests/test_plan_mode_hooks.py         |   23 +-\n config/hooks/tests/test_sticky_session.py          |   45 +-\n config/hooks/tests/test_sv_validators.py           |   91 +-\n config/skills/appfix/SKILL.md                      | 1367 ++------------------\n .../skills/appfix/references/checkpoint-schema.md  |   76 ++\n .../appfix/references/infrastructure-sync.md       |   28 +\n .../skills/appfix/references/surf-verification.md  |   57 +\n config/skills/appfix/references/troubleshooting.md |   57 +\n config/skills/appfix/references/worktree-guide.md  |   70 +\n config/skills/heavy/SKILL.md                       |   25 +-\n config/skills/mobileappfix/SKILL.md                |  127 +-\n .../mobileappfix/references/debugging-rubric.md    |  372 ++++++\n .../references/maestro-mcp-contract.md             |  239 ++++\n .../references/maestro-smoke-contract.md           |  254 ++++\n .../mobileappfix/references/mobile-topology.md     |  299 +++++\n .../references/validation-tests-contract.md        |  251 ++++\n config/skills/revonc-eas-deploy/SKILL.md           |  329 +++++\n config/skills/skill-sandbox/SKILL.md               |  697 ++++++++++\n .../skills/skill-sandbox/scripts/sandbox-setup.sh  |  473 +++++++\n config/skills/skill-tester/SKILL.md                |   45 +\n config/skills/skill-tester/scripts/test-skill.sh   |  227 ++++\n config/skills/skilltest/SKILL.md                   |   46 +\n config/skills/toolkit/SKILL.md                     |   55 +-\n .../toolkit/references/claude-md-optimizer.md      |  321 +++++\n docs/concepts/skills.md                            |  130 ++\n docs/research/agentic-ai-2026-research-report.md   | 1206 +++++++++++++++++\n scripts/skill-tester.sh                            |  452 +++++++\n scripts/test-sticky-session-e2e.sh                 |  494 +++++++\n 43 files changed, 6852 insertions(+), 3909 deletions(-)\n\ndiff --git a/README.md b/README.md\nindex 7b74e46..49f9f8e 100644\n--- a/README.md\n+++ b/README.md\n@@ -97,7 +97,7 @@ Claude cannot stop until the job is actually done. A completion checkpoint enfor\n \n If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n \n-### Hook System (15 registered)\n+### Hook System (19 registered)\n \n | Hook | Event | Purpose |\n |------|-------|---------|\n@@ -106,11 +106,15 @@ If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n | `read-docs-reminder.py` | SessionStart | Forces reading docs on start |\n | `skill-state-initializer.py` | UserPromptSubmit | Creates state files on `/godo` or `/appfix` |\n | `read-docs-trigger.py` | UserPromptSubmit | Suggests reading relevant docs |\n+| `pretooluse-auto-approve.py` | PreToolUse (*) | Auto-approves during autonomous mode |\n | `plan-mode-enforcer.py` | PreToolUse (Edit/Write) | Blocks Edit/Write until plan mode completes |\n | `deploy-enforcer.py` | PreToolUse (Bash) | Blocks subagent/production deploys |\n+| `azure-command-guard.sh` | PreToolUse (Bash) | Guards Azure CLI commands |\n+| `exa-search-enforcer.py` | PreToolUse (WebSearch) | Reminds to use Exa MCP instead |\n | `checkpoint-invalidator.py` | PostToolUse (Edit/Write) | Resets checkpoint when code changes |\n | `checkpoint-write-validator.py` | PostToolUse (Write) | Warns on claims without evidence |\n | `bash-version-tracker.py` | PostToolUse (Bash) | Tracks version changes after commits |\n+| `doc-updater-async.py` | PostToolUse (Bash) | Suggests doc updates after commits |\n | `plan-mode-tracker.py` | PostToolUse (ExitPlanMode) | Marks plan mode completed |\n | `plan-execution-reminder.py` | PostToolUse (ExitPlanMode) | Injects autonomous execution context |\n | `skill-continuation-reminder.py` | PostToolUse (Skill) | Continues loop after skill delegation |\n@@ -158,6 +162,7 @@ If `is_job_complete: false` \u2192 Claude is **blocked** and must continue working.\n | `design-improver` | UI review, design audit |\n | `ux-improver` | UX review, usability audit |\n | `docs-navigator` | Documentation, \"read the docs\" |\n+| `revonc-eas-deploy` | /eas, \"deploy to testflight\", \"build ios/android\" |\n \n ---\n \n@@ -186,6 +191,7 @@ claude-code-toolkit/\n | [QUICKSTART.md](QUICKSTART.md) | Installation guide |\n | [docs/index.md](docs/index.md) | Full reference |\n | [docs/skills/appfix-guide.md](docs/skills/appfix-guide.md) | Complete appfix guide |\n+| [docs/skills/godo-guide.md](docs/skills/godo-guide.md) | Autonomous task execution guide |\n | [docs/concepts/hooks.md](docs/concepts/hooks.md) | Hook system deep dive |\n \n ---\ndiff --git a/config/hooks/_common.py b/config/hooks/_common.py\nindex 1811083..93651d5 100755\n--- a/config/hooks/_common.py\n+++ b/config/hooks/_common.py\n@@ -875,7 +875,99 @@ def save_checkpoint(cwd: str, checkpoint: dict) -> bool:\n         return False\n     checkpoint_path = Path(cwd) / \".claude\" / \"completion-checkpoint.json\"\n     try:\n+        checkpoint_path.parent.mkdir(parents=True, exist_ok=True)\n         checkpoint_path.write_text(json.dumps(checkpoint, indent=2))\n         return True\n     except IOError:\n         return False\n+\n+\n+# ============================================================================\n+# Checkpoint Invalidation (shared by checkpoint-invalidator, bash-version-tracker, stop-validator)\n+# ============================================================================\n+\n+# Code file extensions that trigger checkpoint invalidation\n+CODE_EXTENSIONS = {\n+    \".py\", \".ts\", \".tsx\", \".js\", \".jsx\", \".go\", \".rs\", \".java\", \".rb\", \".php\",\n+    \".vue\", \".svelte\",\n+    \".tf\", \".tfvars\", \".bicep\",\n+    \".yaml\", \".yml\",\n+    \".sql\", \".sh\", \".bash\",\n+}\n+\n+# Fields invalidated when code changes (in dependency order)\n+# When a field is invalidated, all fields that depend on it are also invalidated\n+FIELD_DEPENDENCIES = {\n+    \"linters_pass\": [],\n+    \"deployed\": [\"linters_pass\"],\n+    \"web_testing_done\": [\"deployed\"],\n+}\n+\n+# All version-dependent fields\n+VERSION_DEPENDENT_FIELDS = list(FIELD_DEPENDENCIES.keys())\n+\n+\n+def is_code_file(file_path: str) -> bool:\n+    \"\"\"Check if file is a code file based on extension.\"\"\"\n+    return Path(file_path).suffix.lower() in CODE_EXTENSIONS\n+\n+\n\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}