{
  "type": "doc-update",
  "created_at": "2026-01-30T13:11:08.409654+00:00",
  "status": "pending",
  "commit_message": "feat(forge): enforce all 4 lite-heavy agents via hooks\n\nPreviously, only 2 of 4 agents (First Principles + AGI-Pilled) were\nhook-enforced. Dynamic agents were \"documentation-only\", which let the\nmodel skip them. This caused the model to launch only 1 agent when\nblocked by the enforcer instead of all 4.\n\nChanges:\n- lite-heavy-tracker: detect dynamic agents via keyword matching\n  (perspective/analysis/review/expert) on general-purpose/opus Tasks\n- lite-heavy-enforcer: require dynamic_agents_launched >= 2\n- Block message now shows all 4 requirements with progress counter\n  and explicitly says \"SINGLE message, four Task calls\"\n- Updated SKILL.md, docs/index.md, forge-guide.md to reflect 4-agent\n  enforcement\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>",
  "diff_content": "commit 7cda0c424483ddaa117d398e565847f66703082e\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 14:11:08 2026 +0100\n\n    feat(forge): enforce all 4 lite-heavy agents via hooks\n    \n    Previously, only 2 of 4 agents (First Principles + AGI-Pilled) were\n    hook-enforced. Dynamic agents were \"documentation-only\", which let the\n    model skip them. This caused the model to launch only 1 agent when\n    blocked by the enforcer instead of all 4.\n    \n    Changes:\n    - lite-heavy-tracker: detect dynamic agents via keyword matching\n      (perspective/analysis/review/expert) on general-purpose/opus Tasks\n    - lite-heavy-enforcer: require dynamic_agents_launched >= 2\n    - Block message now shows all 4 requirements with progress counter\n      and explicitly says \"SINGLE message, four Task calls\"\n    - Updated SKILL.md, docs/index.md, forge-guide.md to reflect 4-agent\n      enforcement\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/lite-heavy-enforcer.py | 46 ++++++++++++++++++++++++++++---------\n config/hooks/lite-heavy-tracker.py  | 41 ++++++++++++++++++++++++++++++---\n config/skills/forge/SKILL.md        | 12 +++++-----\n docs/index.md                       |  2 +-\n docs/skills/forge-guide.md          |  8 +++----\n 5 files changed, 84 insertions(+), 25 deletions(-)\n\ndiff --git a/config/hooks/lite-heavy-enforcer.py b/config/hooks/lite-heavy-enforcer.py\nindex 4d16d99..693a3cb 100644\n--- a/config/hooks/lite-heavy-enforcer.py\n+++ b/config/hooks/lite-heavy-enforcer.py\n@@ -2,10 +2,11 @@\n \"\"\"\n PreToolUse hook to enforce Lite Heavy execution before ExitPlanMode for /forge.\n \n-Blocks ExitPlanMode until:\n+Blocks ExitPlanMode until ALL 4 agents have been launched:\n 1. heavy/SKILL.md has been read\n 2. \"First Principles\" Task agent has been launched\n 3. \"AGI-Pilled\" Task agent has been launched\n+4. 2 dynamic Task agents have been launched (task-specific perspectives)\n \n The tracking is done by lite-heavy-tracker.py (PostToolUse hook).\n This hook only checks the state and blocks if requirements aren't met.\n@@ -34,7 +35,7 @@ BLOCK_MESSAGE = \"\"\"\n \u2551  \u26a0\ufe0f  LITE HEAVY PLANNING REQUIRED - /forge                                    \u2551\n \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n \n-Before exiting plan mode, you MUST complete Lite Heavy planning:\n+Before exiting plan mode, you MUST launch ALL 4 Opus agents.\n \n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502  REQUIRED STEPS:                                                                \u2502\n@@ -42,16 +43,27 @@ Before exiting plan mode, you MUST complete Lite Heavy planning:\n \u2502  {step1}  1. Read ~/.claude/skills/heavy/SKILL.md (get agent prompts)           \u2502\n \u2502  {step2}  2. Launch Task: \"First Principles Analysis\" (from heavy)              \u2502\n \u2502  {step3}  3. Launch Task: \"AGI-Pilled Analysis\" (from heavy)                    \u2502\n-\u2502  4. Synthesize their responses into your plan                                   \u2502\n+\u2502  {step4}  4. Launch 2 dynamic Task agents (task-specific perspectives)          \u2502\n+\u2502           ({dynamic_count}/2 launched)                                          \u2502\n+\u2502  5. Synthesize ALL 4 agents' responses into your plan                           \u2502\n \u2502                                                                                 \u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n \n-WHY LITE HEAVY?\n-- First Principles asks: \"What can be deleted? What's over-engineered?\"\n-- AGI-Pilled asks: \"What would god-tier AI implementation look like?\"\n-- Together they prevent both over-engineering AND under-ambition\n+\u26a0\ufe0f  CRITICAL: Launch ALL 4 agents in a SINGLE message (one message, four Task calls).\n+Do NOT launch them one at a time. They must run in PARALLEL.\n \n-Complete the missing steps, then ExitPlanMode again.\n+Dynamic agents = task-specific perspectives. Ask:\n+\"For THIS task, who would argue about it at a company meeting?\"\n+Pick 2 perspectives that catch what First Principles and AGI-Pilled miss.\n+Use \"perspective\", \"analysis\", \"review\", or \"expert\" in the Task description.\n+\n+WHY 4 AGENTS?\n+- First Principles: \"What can be deleted? What's over-engineered?\"\n+- AGI-Pilled: \"What would god-tier AI implementation look like?\"\n+- Dynamic 1: Domain expertise \u2014 \"What does [expert] see?\"\n+- Dynamic 2: Adversarial review \u2014 \"What could go wrong?\"\n+\n+Complete ALL missing steps, then ExitPlanMode again.\n \"\"\".strip()\n \n \n@@ -85,11 +97,18 @@ def main():\n     heavy_skill_read = lite_heavy.get(\"heavy_skill_read\", False)\n     first_principles_launched = lite_heavy.get(\"first_principles_launched\", False)\n     agi_pilled_launched = lite_heavy.get(\"agi_pilled_launched\", False)\n+    dynamic_agents_launched = lite_heavy.get(\"dynamic_agents_launched\", 0)\n \n     # If all requirements met, allow ExitPlanMode\n-    if heavy_skill_read and first_principles_launched and agi_pilled_launched:\n+    all_met = (\n+        heavy_skill_read\n+        and first_principles_launched\n+        and agi_pilled_launched\n+        and dynamic_agents_launched >= 2\n+    )\n+    if all_met:\n         log_debug(\n-            \"Lite Heavy requirements met, allowing ExitPlanMode\",\n+            \"Lite Heavy requirements met (4 agents), allowing ExitPlanMode\",\n             hook_name=\"lite-heavy-enforcer\"\n         )\n         sys.exit(0)\n@@ -98,8 +117,12 @@ def main():\n     step1 = \"\u2713\" if heavy_skill_read else \"\u2717\"\n     step2 = \"\u2713\" if first_principles_launched else \"\u2717\"\n     step3 = \"\u2713\" if agi_pilled_launched else \"\u2717\"\n+    step4 = \"\u2713\" if dynamic_agents_launched >= 2 else \"\u2717\"\n \n-    message = BLOCK_MESSAGE.format(step1=step1, step2=step2, step3=step3)\n+    message = BLOCK_MESSAGE.format(\n+        step1=step1, step2=step2, step3=step3, step4=step4,\n+        dynamic_count=dynamic_agents_launched\n+    )\n \n     log_debug(\n         \"Blocking ExitPlanMode - Lite Heavy incomplete\",\n@@ -108,6 +131,7 @@ def main():\n             \"heavy_skill_read\": heavy_skill_read,\n             \"first_principles_launched\": first_principles_launched,\n             \"agi_pilled_launched\": agi_pilled_launched,\n+            \"dynamic_agents_launched\": dynamic_agents_launched,\n         }\n     )\n \ndiff --git a/config/hooks/lite-heavy-tracker.py b/config/hooks/lite-heavy-tracker.py\nindex 8febee1..e8a3ea1 100644\n--- a/config/hooks/lite-heavy-tracker.py\n+++ b/config/hooks/lite-heavy-tracker.py\n@@ -5,6 +5,7 @@ PostToolUse hook to track Lite Heavy progress for /forge skill.\n Tracks when:\n 1. heavy/SKILL.md is read\n 2. Task agents with \"First Principles\" or \"AGI-Pilled\" in description are launched\n+3. Dynamic Task agents are launched (general-purpose/opus with perspective/analysis/review/expert keywords)\n \n Updates forge-state.json with lite_heavy_verification status.\n \n@@ -38,8 +39,13 @@ def is_heavy_skill_path(file_path: str) -> bool:\n     )\n \n \n-def detect_agent_type(task_description: str) -> str | None:\n-    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\"\"\"\n+def detect_agent_type(task_description: str, subagent_type: str = \"\", model: str = \"\") -> str | None:\n+    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\n+\n+    Returns:\n+        \"first_principles\", \"agi_pilled\", \"dynamic\" (for task-specific perspectives),\n+        or None (for non-Lite-Heavy tasks like Explore agents).\n+    \"\"\"\n     if not task_description:\n         return None\n \n@@ -51,6 +57,17 @@ def detect_agent_type(task_description: str) -> str | None:\n     if \"agi-pilled\" in desc_lower or \"agi pilled\" in desc_lower or \"agipilled\" in desc_lower:\n         return \"agi_pilled\"\n \n+    # Dynamic agents: general-purpose opus Tasks that aren't FP or AGI-Pilled\n+    # These are the task-specific perspectives (e.g., \"Security Engineer perspective\")\n+    # Exclude Explore, Bash, Plan agents which are codebase exploration, not Lite Heavy\n+    non_dynamic_types = {\"Explore\", \"Bash\", \"Plan\", \"claude-code-guide\", \"statusline-setup\"}\n+    if subagent_type n\n\n... [truncated - diff too long]",
  "existing_docs": [
    "docs/architecture.md",
    "docs/index.md",
    "docs/philosophy.md",
    "README.md",
    ".claude/MEMORIES.md"
  ],
  "instructions": "\nDOCUMENTATION UPDATE TASK\n\nA commit was just made in an appfix/godo session. Your job is to:\n\n1. Analyze the diff to understand what changed\n2. Determine which documentation files need updating\n3. Update the relevant docs to reflect the changes\n\nCOMMIT MESSAGE:\nfeat(forge): enforce all 4 lite-heavy agents via hooks\n\nPreviously, only 2 of 4 agents (First Principles + AGI-Pilled) were\nhook-enforced. Dynamic agents were \"documentation-only\", which let the\nmodel skip them. This caused the model to launch only 1 agent when\nblocked by the enforcer instead of all 4.\n\nChanges:\n- lite-heavy-tracker: detect dynamic agents via keyword matching\n  (perspective/analysis/review/expert) on general-purpose/opus Tasks\n- lite-heavy-enforcer: require dynamic_agents_launched >= 2\n- Block message now shows all 4 requirements with progress counter\n  and explicitly says \"SINGLE message, four Task calls\"\n- Updated SKILL.md, docs/index.md, forge-guide.md to reflect 4-agent\n  enforcement\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n\nEXISTING DOCUMENTATION FILES:\n- docs/architecture.md\n- docs/index.md\n- docs/philosophy.md\n- README.md\n- .claude/MEMORIES.md\n\nDIFF CONTENT:\ncommit 7cda0c424483ddaa117d398e565847f66703082e\nAuthor: olivier-motium <243932812+olivier-motium@users.noreply.github.com>\nDate:   Fri Jan 30 14:11:08 2026 +0100\n\n    feat(forge): enforce all 4 lite-heavy agents via hooks\n    \n    Previously, only 2 of 4 agents (First Principles + AGI-Pilled) were\n    hook-enforced. Dynamic agents were \"documentation-only\", which let the\n    model skip them. This caused the model to launch only 1 agent when\n    blocked by the enforcer instead of all 4.\n    \n    Changes:\n    - lite-heavy-tracker: detect dynamic agents via keyword matching\n      (perspective/analysis/review/expert) on general-purpose/opus Tasks\n    - lite-heavy-enforcer: require dynamic_agents_launched >= 2\n    - Block message now shows all 4 requirements with progress counter\n      and explicitly says \"SINGLE message, four Task calls\"\n    - Updated SKILL.md, docs/index.md, forge-guide.md to reflect 4-agent\n      enforcement\n    \n    Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n---\n config/hooks/lite-heavy-enforcer.py | 46 ++++++++++++++++++++++++++++---------\n config/hooks/lite-heavy-tracker.py  | 41 ++++++++++++++++++++++++++++++---\n config/skills/forge/SKILL.md        | 12 +++++-----\n docs/index.md                       |  2 +-\n docs/skills/forge-guide.md          |  8 +++----\n 5 files changed, 84 insertions(+), 25 deletions(-)\n\ndiff --git a/config/hooks/lite-heavy-enforcer.py b/config/hooks/lite-heavy-enforcer.py\nindex 4d16d99..693a3cb 100644\n--- a/config/hooks/lite-heavy-enforcer.py\n+++ b/config/hooks/lite-heavy-enforcer.py\n@@ -2,10 +2,11 @@\n \"\"\"\n PreToolUse hook to enforce Lite Heavy execution before ExitPlanMode for /forge.\n \n-Blocks ExitPlanMode until:\n+Blocks ExitPlanMode until ALL 4 agents have been launched:\n 1. heavy/SKILL.md has been read\n 2. \"First Principles\" Task agent has been launched\n 3. \"AGI-Pilled\" Task agent has been launched\n+4. 2 dynamic Task agents have been launched (task-specific perspectives)\n \n The tracking is done by lite-heavy-tracker.py (PostToolUse hook).\n This hook only checks the state and blocks if requirements aren't met.\n@@ -34,7 +35,7 @@ BLOCK_MESSAGE = \"\"\"\n \u2551  \u26a0\ufe0f  LITE HEAVY PLANNING REQUIRED - /forge                                    \u2551\n \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n \n-Before exiting plan mode, you MUST complete Lite Heavy planning:\n+Before exiting plan mode, you MUST launch ALL 4 Opus agents.\n \n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502  REQUIRED STEPS:                                                                \u2502\n@@ -42,16 +43,27 @@ Before exiting plan mode, you MUST complete Lite Heavy planning:\n \u2502  {step1}  1. Read ~/.claude/skills/heavy/SKILL.md (get agent prompts)           \u2502\n \u2502  {step2}  2. Launch Task: \"First Principles Analysis\" (from heavy)              \u2502\n \u2502  {step3}  3. Launch Task: \"AGI-Pilled Analysis\" (from heavy)                    \u2502\n-\u2502  4. Synthesize their responses into your plan                                   \u2502\n+\u2502  {step4}  4. Launch 2 dynamic Task agents (task-specific perspectives)          \u2502\n+\u2502           ({dynamic_count}/2 launched)                                          \u2502\n+\u2502  5. Synthesize ALL 4 agents' responses into your plan                           \u2502\n \u2502                                                                                 \u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n \n-WHY LITE HEAVY?\n-- First Principles asks: \"What can be deleted? What's over-engineered?\"\n-- AGI-Pilled asks: \"What would god-tier AI implementation look like?\"\n-- Together they prevent both over-engineering AND under-ambition\n+\u26a0\ufe0f  CRITICAL: Launch ALL 4 agents in a SINGLE message (one message, four Task calls).\n+Do NOT launch them one at a time. They must run in PARALLEL.\n \n-Complete the missing steps, then ExitPlanMode again.\n+Dynamic agents = task-specific perspectives. Ask:\n+\"For THIS task, who would argue about it at a company meeting?\"\n+Pick 2 perspectives that catch what First Principles and AGI-Pilled miss.\n+Use \"perspective\", \"analysis\", \"review\", or \"expert\" in the Task description.\n+\n+WHY 4 AGENTS?\n+- First Principles: \"What can be deleted? What's over-engineered?\"\n+- AGI-Pilled: \"What would god-tier AI implementation look like?\"\n+- Dynamic 1: Domain expertise \u2014 \"What does [expert] see?\"\n+- Dynamic 2: Adversarial review \u2014 \"What could go wrong?\"\n+\n+Complete ALL missing steps, then ExitPlanMode again.\n \"\"\".strip()\n \n \n@@ -85,11 +97,18 @@ def main():\n     heavy_skill_read = lite_heavy.get(\"heavy_skill_read\", False)\n     first_principles_launched = lite_heavy.get(\"first_principles_launched\", False)\n     agi_pilled_launched = lite_heavy.get(\"agi_pilled_launched\", False)\n+    dynamic_agents_launched = lite_heavy.get(\"dynamic_agents_launched\", 0)\n \n     # If all requirements met, allow ExitPlanMode\n-    if heavy_skill_read and first_principles_launched and agi_pilled_launched:\n+    all_met = (\n+        heavy_skill_read\n+        and first_principles_launched\n+        and agi_pilled_launched\n+        and dynamic_agents_launched >= 2\n+    )\n+    if all_met:\n         log_debug(\n-            \"Lite Heavy requirements met, allowing ExitPlanMode\",\n+            \"Lite Heavy requirements met (4 agents), allowing ExitPlanMode\",\n             hook_name=\"lite-heavy-enforcer\"\n         )\n         sys.exit(0)\n@@ -98,8 +117,12 @@ def main():\n     step1 = \"\u2713\" if heavy_skill_read else \"\u2717\"\n     step2 = \"\u2713\" if first_principles_launched else \"\u2717\"\n     step3 = \"\u2713\" if agi_pilled_launched else \"\u2717\"\n+    step4 = \"\u2713\" if dynamic_agents_launched >= 2 else \"\u2717\"\n \n-    message = BLOCK_MESSAGE.format(step1=step1, step2=step2, step3=step3)\n+    message = BLOCK_MESSAGE.format(\n+        step1=step1, step2=step2, step3=step3, step4=step4,\n+        dynamic_count=dynamic_agents_launched\n+    )\n \n     log_debug(\n         \"Blocking ExitPlanMode - Lite Heavy incomplete\",\n@@ -108,6 +131,7 @@ def main():\n             \"heavy_skill_read\": heavy_skill_read,\n             \"first_principles_launched\": first_principles_launched,\n             \"agi_pilled_launched\": agi_pilled_launched,\n+            \"dynamic_agents_launched\": dynamic_agents_launched,\n         }\n     )\n \ndiff --git a/config/hooks/lite-heavy-tracker.py b/config/hooks/lite-heavy-tracker.py\nindex 8febee1..e8a3ea1 100644\n--- a/config/hooks/lite-heavy-tracker.py\n+++ b/config/hooks/lite-heavy-tracker.py\n@@ -5,6 +5,7 @@ PostToolUse hook to track Lite Heavy progress for /forge skill.\n Tracks when:\n 1. heavy/SKILL.md is read\n 2. Task agents with \"First Principles\" or \"AGI-Pilled\" in description are launched\n+3. Dynamic Task agents are launched (general-purpose/opus with perspective/analysis/review/expert keywords)\n \n Updates forge-state.json with lite_heavy_verification status.\n \n@@ -38,8 +39,13 @@ def is_heavy_skill_path(file_path: str) -> bool:\n     )\n \n \n-def detect_agent_type(task_description: str) -> str | None:\n-    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\"\"\"\n+def detect_agent_type(task_description: str, subagent_type: str = \"\", model: str = \"\") -> str | None:\n+    \"\"\"Detect if the Task description indicates a Lite Heavy agent.\n+\n+    Returns:\n+        \"first_principles\", \"agi_pilled\", \"dynamic\" (for task-specific perspectives),\n+        or None (for non-Lite-Heavy tasks like Explore agents).\n+    \"\"\"\n     if not task_description:\n         return None\n \n@@ -51,6 +57,17 @@ def detect_agent_type(task_description: str) -> str | None:\n     if \"agi-pilled\" in desc_lower or \"agi pilled\" in desc_lower or \"agipilled\" in desc_lower:\n         return \"agi_pilled\"\n \n+    # Dynamic agents: general-purpose opus Tasks that aren't FP or AGI-Pilled\n+    # These are the task-specific perspectives (e.g., \"Security Engineer perspective\")\n+    # Exclude Explore, Bash, Plan agents which are codebase exploration, not Lite Heavy\n+    non_dynamic_types = {\"Explore\", \"Bash\", \"Plan\", \"claude-code-guide\", \"statusline-setup\"}\n+    if subagent_type n\n\n... [truncated - diff too long]\n\nINSTRUCTIONS:\n- Only update docs that are actually affected by this change\n- Keep updates concise and accurate\n- Don't add unnecessary documentation\n- If the change is purely code (no architectural/API changes), you may skip doc updates\n- Focus on: API changes, new features, architectural decisions, configuration changes\n\nUse the /heavy skill if you need multiple perspectives on what to document.\n"
}